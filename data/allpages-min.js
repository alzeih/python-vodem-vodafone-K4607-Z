function helpmobile(){$.extend(this,{views:["mobileView"],name:"help-mobile",parent:"welcome",menuName:"HELP",children:["diagnostics","deviceControls","support","about","network-unlock"],backButton:"home-mobile"})}function advancedsettings(){var d;function c(){var k=VendorWifi.GetRouterBackupUrl();$("#advancedSettingsBackupBtn").attr("href",k.backupUrl)}function j(){$("body").on("click","#advancedSettingsResetBtn",g);$("#loadPage").find("input").click(function(){$("#updateMessage").remove()})}function h(k){d=k.backupUrl;$("#advancedSettingsBackupBtn").attr("href",d);throbber.hide()}var a={titleTrClass:"TR_RESTORE_YOUR_ROUTER",messageTrClass:"TR_RESTORE_YOUR_ROUTER_PROMPT_TEXT",button1TrClass:"ERROR_OK",button2TrClass:"TR_ERROR_CANCEL"};var e={titleTrClass:"FACTORY_SETTINGS",messageTrClass:"WARNING_MESSAGE",button1TrClass:"ERROR_OK",button2TrClass:"TR_ERROR_CANCEL"};function g(){UserNotification.showPrompt(function(k){if(k){throbber.show();$("#throbberText").setTranslation(languageManager.DEVICE_REBOOTING);RestoreFactorySettings(function(l){if(!l){throbber.hide()}})}else{return}},e)}function b(){if(!UserNotification.formValidated()){return}var k=$("#uploadfile1")[0].value;if(k!==""){UserNotification.showPrompt(function(l){if(l){FileUploader.finalisationCallback=function(){FileUploader.showUploadRestoreFileForm("#chooseFile")};FileUploader.doUpload()}},a)}}function f(){FileUploader.onUploadFileButton=b;VendorWifi.GetRouterBackupUrl({},h);FileUploader.showUploadRestoreFileForm("#chooseFile");j();c();page.dataReceived()}$.extend(this,{menuName:"TR_ROUTER_ADVANCED",views:["desktopView"],requiresLoggedIn:true,isMobileWifi:true,doSpecificStuff:f,name:"advanced-settings",parent:"router-settings",renderLayout:layout.threeColumn})}function dmzsettings(){function a(){var d;function c(g){d=g;f(d.dmzEnabled);$("#dmzComIPAddress").val(d.dmzIpAddress);$(".showHideForm").toggle(d.dmzEnabled);throbber.hide();page.dataReceived()}VendorWifi.GetDmzSettings({},c);function b(){$.extend(d,{dmzEnabled:$("#frmDmzSettings").find(".dmzEnabledtrue").prop("checked"),dmzIpAddress:$("#dmzComIPAddress").val()});VendorWifi.SetDmzSettings(d,function(){UserNotification.showSuccessResponse();VendorWifi.GetDmzSettings({},c);throbber.hide()})}function f(g){$("#frmDmzSettings").find(".dmzEnabled"+g.toString()).prop("checked",true)}function e(){$("#dmzSettingsSaveBtn").setButtonAction(b);$("#mainContent").on("change","#frmDmzSettings *[name=dmzEnabled]",function(){$(".showHideForm").toggle($(this).val())})}e()}$.extend(this,{menuName:"TR_DMZ_SETTINGS",views:["desktopView"],requiresLoggedIn:true,isMobileWifi:true,doSpecificStuff:a,name:"dmz-settings",parent:"router-settings",renderLayout:layout.threeColumn})}function filesharing(){var k={sharedFolder:"/"};var a=[];function g(){$("body").on("click","#loadPage",function(){$("#updateMessage").remove()})}function d(){var m=k.access!=="none";$(".showHideForm").toggle(m);$(".fileSharing"+m).prop("checked",true);$("#shareGuestsType").val(k.access);$("#sdCard").empty();$.tmpl(HTMLTemplates.sdCardItem,{}).appendTo("#sdCard");$("#sdCard *").translateElements();$("#fileList").empty();var l=false;$.each(a,function(n,o){var p={isOdd:l,fileTitle:o.name,bytesUsed:o.size,folderPath:o.fileUrlOrFolderPath,checked:o.fileUrlOrFolderPath===k.sharedFolder,index:n+1};$.tmpl(HTMLTemplates.folderItem,p).appendTo("#fileList");l=!l});e(m);page.dataReceived()}function j(l){return $.grep(l.files,function(n,m){return n.type==="folder"})}function e(o){$("input[type='radio']").removeAttr("disabled");var n=VendorWifi.GetSdCardSharing();var m=n.sdCardStatus;if(m){$("body").off("click",".radioButtons").on("click",".radioButtons",h).off("click","#fileShareBtn").on("click","#fileShareBtn",h);var l=n.access;$("#storageCardNotPresent").hide();if("none"===l){$(".showHideForm").hide();$("#fileStorageItemWrapper").hide();$("#fileShareBtn").hide();$("#fileSharingSaveBtn").toggle(o)}else{$(".showHideForm").toggle(o);$("#fileStorageItemWrapper").toggle(o);$("#fileShareBtn").toggle(o);$("#fileSharingSaveBtn").toggle(!o)}}else{$("#storageCardNotPresent").show();$("input[type='radio']").prop("disabled",true);$(".showHideForm").hide();$("#fileStorageItemWrapper").hide();$("#fileShareBtn").hide();$("#fileSharingSaveBtn").hide()}}function f(){k=VendorWifi.GetSdCardSharing(k);if(k.access!=="none"&&k.sdCardStatus){a=j(VendorWifi.GetFileList({folderPath:"/"}))}d()}function b(l){guestUserLogic.enableFileStorage($("input[name=httpSharing]:checked").val()==="yes");f();UserNotification.showGenericVendorResponse(l)}function h(){throbber.show();var l=$("input[name=httpSharing]:checked").val()==="no"?"none":$("#shareGuestsType").val();k.access=l;k.sharedFolder=$("input[name=fileItemShare]:checked").val();VendorWifi.SetSdCardSharing(k,function(m){b(true)},function(){b(false)})}function c(){g();f()}$.extend(this,{menuName:"TR_FILE_SHARING",views:["desktopView"],requiresLoggedIn:true,isMobileWifi:true,doSpecificStuff:c,name:"file-sharing",parent:"file-storage"})}function filestorage(){var p;var x;var d=[];function t(){p=VendorWifi.GetSdCardSharing({});if(!p.sdCardStatus){$("#storageCardNotPresent").show();$("#fileStorage1").hide();return}else{if(!authentication.isLoggedIn()&&p.access==="none"){$("#storageCardNotPresent").setTranslation("TR_PLEASE_CONTACT_ADMIN_REGARDING_FILE_SHARING").show();$("#fileStorage1").hide();return}else{if(p.access==="readOnly"&&!authentication.isLoggedIn()){$(".readOnly").hide()}else{$(".TR_STORAGE_CARD_PERMISSIONS").hide()}}}x=authentication.isLoggedIn()?"":p.sharedFolder;$("#storageCardNotPresent").hide();d=[{folderName:languageManager.TR_STORAGE_CARD_FOLDER_ROOT,translationClass:"TR_STORAGE_CARD_FOLDER_ROOT",folderPath:"/"+x}]}function z(C){var D=[];var B=0;$.each(C,function(){var E={};E.fileUrlOrFolderPath=this.fileUrlOrFolderPath;E.lastUpdated=this.lastUpdated;E.name=this.name;E.size=this.size;E.type=this.type;D[B]=E;B++});return D}function k(D,C){var E=VendorWifi.GetSdCardSharing({});if(!E.sdCardStatus){$("#storageCardNotPresent").show();$("#fileStorageLandingWrapper").show();$("#fileStorage1").hide();$("#fileStorageListLandingWrapper").hide();$("#breadcrumbMenu").hide();page.dataReceived();throbber.hide();return}var B=z(D.files);$("#fileStorageLandingWrapper:visible, #fileStorageDeleteBtn:visible").hide();$.each(B,function(F){this.className=F%2===0?"odd":"even";this.isFolder=this.type==="folder"});$("#fileStorageItemWrapper").html($.tmpl(HTMLTemplates.fileListItem,B)).show();if(B.length>0){$("#fileStorageDeleteBtn").show()}if(E.access==="readOnly"&&!authentication.isLoggedIn()){$("#fileStorageCard").hide()}else{$("#fileStorageCard").show()}$("#mainContent *").translateElements();if(C){e()}$(document).scrollTop(0);if(E.access==="readOnly"&&!authentication.isLoggedIn()){$(".readOnly").hide()}page.dataReceived()}function m(B){d.push(B)}function c(B){d=d.slice(0,B)}function A(B){k(B,false)}function o(){VendorWifi.GetFileList({folderPath:x===""?authentication.isLoggedIn()?"/":p.sharedFolder:x},A);WiFiShared.updateSdMemorySizes(function(){$("#mainContent *").translateElements();$("#folderButtons").show();e()})}function e(){d=$.each(d,function(){delete this.isLast});d[d.length-1].isLast=true;if(!authentication.isLoggedIn()&&p.sharedFolder!==""&&d.length>1){d[1].folderPath=p.sharedFolder}else{if(d.length===1){$("#sdCardAndImage").show()}}var B=$.tmpl(HTMLTemplates.breadCrumbItem,d);$("#breadcrumbMenu").html(B)}function h(){$("#chooseFile").hide();$("#uploadfile").val("");$(".customUpload").html("&nbsp;");$("#folderName").val("");$("#createFolderButton").removeClass("disabled").addClass("disabled");$("#folderButtons").show();$("#newFolderForm").hide()}function y(B){k(B,true)}function q(C){C.stopPropagation();C.preventDefault();$("#updateMessage").remove();throbber.show();h();var D=$(this).parent("li").index()+1;c(D);var B=$(this).getFileInfo("breadcrumbLinkData");x=B.folderPath;if(D===1){$("#fileStorageLandingWrapper").show();$("#fileStorageItemWrapper, #fileStorageDeleteBtn, #fileStorageCard").hide();e();throbber.hide()}else{VendorWifi.GetFileList({folderPath:B.folderPath},y)}return false}function g(C){C.stopPropagation();C.preventDefault();$("#updateMessage").remove();throbber.show();h();$("#sdCardAndImage").hide();var B=$(this).getFileInfo("pathLinkData");m({folderName:B.folderName,folderPath:B.folderPath});x=B.folderPath;VendorWifi.GetFileList({folderPath:B.folderPath===""?authentication.isLoggedIn()?"/":p.sharedFolder:B.folderPath},y);return false}function v(){throbber.show();var D=$(".fileItemCheckbox:checked");var B=[];D.each(function(){B.push({name:$(this).data("filename")})});var C={folderPath:x===""?authentication.isLoggedIn()?"":p.sharedFolder:x,files:B};VendorWifi.DeleteFilesAndFolders(C,function(){h();o();UserNotification.showGenericVendorResponse(true)},function(){h();o();UserNotification.showResponse({error:true,hintTitleTr:"SENT_DELETE",hintTextTr:"TR_FAILED_TO_DELETE_FILESFOLDER"})})}function f(C){C.stopPropagation();C.preventDefault();var B={button1TrClass:"YES_BTN",button2TrClass:"NO_BTN",titleTrClass:"INBOX_DELETE_CONFIRM",messageTrClass:"STORAGE_DELETE_WARNING"};UserNotification.showPrompt(function(D){if(D){v()}},B);return false}function r(B){B.stopPropagation();B.preventDefault();$("#folderButtons").hide();FileUploader.finalisationCallback=o;FileUploader.showUploadFileForm("#chooseFile",x===""?authentication.isLoggedIn()?"":p.sharedFolder:x);return false}function n(){var C=$("#uploadfile1").val();var B={destinationFolderOnDevice:x===""?authentication.isLoggedIn()?"":p.sharedFolder:x,sourcePathOnLocalMachine:C.substring(C.lastIndexOf("\\"),C.length+1)};FileUploader.ConfirmUpload(B)}function u(B){B.stopPropagation();B.preventDefault();$("#folderButtons").hide();$("#newFolderForm").show();return false}function a(C){C.stopPropagation();C.preventDefault();throbber.show();var D=$("#folderName").val();var B={folderName:D,folderPath:x===""?authentication.isLoggedIn()?"":p.sharedFolder:x};VendorWifi.CreateFolder(B,function(){$("#newFolderForm").hide();$("#folderName").val();o();UserNotification.showGenericVendorResponse(true);FileUploader.resetInterface()},function(){UserNotification.showResponse({error:true,hintTitleTr:"TR_CREATE_FOLDER",hintTextTr:"TR_FAILED_TO_CREATE_FOLDER"});FileUploader.resetInterface()});return false}function b(){UserNotification.validation.validateNewFolderName=function(C){var B=UserNotification.validation.validateFolderName(C);w(B);return B}}function w(B){if(B){$("#mainContent").off("click","#createFolderButton").on("click","#createFolderButton",a);$("#createFolderButton").removeClass("disabled")}else{$("#mainContent").off("click","#fileStorageNewFolderBtn").off("click","#createFolderButton");$("#createFolderButton").removeClass("disabled").addClass("disabled")}}function j(){$("#fullPage").on("click",".pathLink",g).on("click",".breadcrumbLink",q).on("click","#fileStorageDeleteBtn",f).on("click","#fileStorageUploadBtn",r).on("click","#fileStorageNewFolderBtn",u)}function s(){$("body").on("click","#loadPage",function(){$("#updateMessage").remove()});$("#folderName").keyup(function(){w(UserNotification.validation.validateFolderName($("#folderName").val()))});$(document).on("contentTranslated."+pageLoader.getCurrentEventNamespace(),function(){$.each($(".TR_FILE_ITEM"),function(){var D=$(this).attr("fileItemLastUpdated");var B=languageManager.TR_LAST_UPDATED.replace("{{LAST_UPDATED}}",D);var F=$(this).attr("fileItemSize");var E=F?" - "+formatting.getTotalVolumeDisplayString(F):"";var C="<span>"+B+E+"</span>";$(this).html(C)})});j()}function l(){FileUploader.onUploadFileButton=n;b();s();t();e();page.dataReceived()}$.extend(this,{views:["desktopView"],doSpecificStuff:l,name:"file-storage",parent:"file-storage",requiresLoggedIn:true,isValidForGuestUser:guestUserLogic.getCorrectPage})}function macsettings(){var t;var j;var w=(function(){var F=10;function E(I,H){return I+H<=F}function G(){return F}return{canAddToWhiteListBlackList:E,getMaxAllowedDevices:G}}());function q(){if(j!==null&&t!==null){page.dataReceived()}}function u(E){t=deviceMacSettings=E;b();q();m()}function r(){j=WiFiShared.getConnectedDevices();q();m()}function y(){e("authorisedDevices","allowed");e("unauthorisedDevices","disallowed");v();$(".checkboxAllDevices").prop("checked",false);var E=t.macFilteringMode==="whitelist";$(".authTabs").each(function(){if($(this).attr("data-value")===E){$(this).trigger("click",true)}});$(".macFilteringMode"+E).prop("checked",true);throbber.hide()}function m(){if(t===undefined||j===undefined){return}y();$(".macFilteringEnabled"+t.macFilteringEnabled).prop("checked",true);B();$(".connectionType *").translateElements()}function C(){if(t.macFilteringMode==="blacklist"||k("allowed").length>0||!t.macFilteringEnabled){x()}else{b()}}function o(){$("#macSettingsFieldset2 .macItems:visible .deviceDataRow").each(function(){var F=$(this);var E={macAddress:F.find(".macAddress").text(),name:F.find(".hostNameField").val(),description:F.find(".descriptionField").val()};c(E,t.authorizedDevices)});throbber.show();VendorWifi.SetMacSettings(t,function(){UserNotification.showSuccessResponse();t=deviceMacSettings=VendorWifi.GetMacSettings({});j=WiFiShared.getConnectedDevices();y();throbber.hide()},function(){UserNotification.showGenericVendorResponse(false,{hintTextTr:"TR_PLEASE_TRY_LATER"});t=deviceMacSettings=VendorWifi.GetMacSettings({});j=WiFiShared.getConnectedDevices();throbber.hide()});t=j=undefined}function A(){throbber.show();var H=false;var E=[];var F=Util.collect(t.authorizedDevices,function(I){return I.macAddress});$.each(F,function(I,J){E[I]=J.toLowerCase()});$("#tblMacSettings3 .deviceDataRow").each(function(){var J=$(this);if(J.find("input:checked").length===0){return true}if(J.find(".macAddressField").length>0&&$.inArray(J.find(".macAddressField").val().toLowerCase(),E)!==-1){H=true;return true}var I={macAddress:J.find(".macAddressField").val()||J.find(".macAddress").text(),name:J.find(".hostNameField").val(),description:J.find(".descriptionField").val(),connectionType:t.macFilteringMode==="whitelist"?"allowed":"disallowed"};t.authorizedDevices.push(I)});if(H){var G={error:true,hintTitleTr:"TR_DUPLICATED_MACS_TITLE",hintTextTr:"TR_DUPLICATED_MACS_TEXT"};UserNotification.showResponse(G);throbber.hide();return}r();$("#macSettingsAddDeviceBtn").addClass("disabled").unbind("click");$("#macSettingsFieldset3").toggle(t.authorizedDevices.length<w.getMaxAllowedDevices());C()}function d(F,E){t.macFilteringMode=$(this).val();C()}function s(I,G,E){var H=$(I).length>0;var F=$(G);F.toggleClass("disabled",!H);F.unbind("click");if(H){E()}}function n(){s("#macSettingsFieldset3 input[type=checkbox]:checked","#macSettingsAddDeviceBtn",function(){$("#macSettingsAddDeviceBtn").setButtonAction(A,"#tblMacSettings3")});$("#macSettingsFieldset3").toggle(t.authorizedDevices.length<w.getMaxAllowedDevices())}function f(F){if(F){var G=$("#macDevicesRemoveBtn");G.removeClass("buttonGreen").addClass("disabled buttonLight");G.unbind("click");var E={info:true,error:false,hintTitleTr:"TR_MAC_WHITELIST_WARNING_Title",hintTextTr:"TR_MAC_WHITELIST_WARNING_Para"};UserNotification.showResponse(E)}else{z();$("#updateMessage").remove()}}function z(){s("#macSettingsFieldset1 input[type=checkbox]:checked, #macSettingsFieldset2 input[type=checkbox]:checked","#macDevicesRemoveBtn",function(){$("#macDevicesRemoveBtn").click(D)})}function D(){var E={button1TrClass:"ERROR_OK",button2TrClass:"TR_ERROR_CANCEL",titleTrClass:"TR_CONFIRM_REMOVE_DEVICES_TITLE",messageTrClass:"TR_OK_OR_CANCEL"};UserNotification.showPrompt(function(F){if(!F){return}var G=$("#macSettingsFieldset2 .macItems input:checked");if(G.length===0){return}G.each(function(){var I=$(this).closest("tr");var H={macAddress:I.find(".macAddress").text()};h(H,t.authorizedDevices);updateItems=true});r();$("#macDevicesRemoveBtn").addClass("disabled").unbind("click");$("#macSettingsFieldset3").toggle(t.authorizedDevices.length<w.getMaxAllowedDevices());C()},E)}function g(){UserNotification.validation.validateMacAddressIfChecked=function(E){return UserNotification.validation.validateMacAddress(E)||!$("#newMacAddress").find("input[type=checkbox]").prop("checked")}}function c(F,E){$(E).each(function(G){if(this.macAddress===F.macAddress){$.extend(this,F)}})}function h(F,E){$(E).each(function(G){if(this.macAddress===F.macAddress){E.splice(G,1)}})}function b(){var E=$("#macDevicesSaveBtn");E.removeClass("buttonGreen").addClass("disabled buttonLight");E.unbind("click")}function x(){var E=$("#macDevicesSaveBtn");E.removeClass("disabled buttonLight").addClass("buttonGreen");E.setButtonAction(o,"#tblMacSettings1, #tblMacSettings2")}function B(){var E=$("#macFilterEnabledRadio1").prop("checked");$(".showHideForm").toggle(E);if(E){$("#macSettingsFieldset3").toggle(t.authorizedDevices.length<w.getMaxAllowedDevices())}}function k(F){var E=$.grep(t.authorizedDevices,function(G){return G.connectionType===F});return E}function l(G,F){$(G).empty();var E=true;$.each(F,function(I,J){var H={isOdd:E,macAddress:J.macAddress,name:J.name||J.hostName,description:J.description,itemIndex:I,isUserForm:J.isUserForm,disabled:F.disabled};$.tmpl(HTMLTemplates.macAddressItem,H).appendTo(G);$(G).find("*").translateElements();E=!E})}function e(F,G){var E=k(G);E.disabled='disabled="disabled"';l("#"+F,E)}function v(){$.each(t.authorizedDevices,function(){h(this,j)});var F=$.extend(true,[],j);var E={macAddress:"",name:"",description:"",isUserForm:true};F.push(E);F.disabled="";l("#unknownDevices",F)}function a(){$("#mainContent").on("keypress","#macSettingsFieldset1 input[type!=checkbox], #macSettingsFieldset2 input[type!=checkbox]",C).on("change","#macSettingsFieldset3 input[type=checkbox]",n).on("change","input[name=macFilteringMode]",d).on("change","#macFilterEnabledRadios .radioButtons",function(){t.macFilteringEnabled=$("#macFilterEnabledRadio1").prop("checked");B();C()}).on("click",".checkboxAllDevices",function(){var E=this.checked;$(this).closest("table").find(".macItems input[type=checkbox]").each(function(F){if($(this).parent().parent().attr("id")!=="newMacAddress"){$(this).prop("checked",E)}});if($(this).closest("table").attr("id")==="tblMacSettings"){f(E)}else{z()}}).on("keydown","#newMacAddress input[type=text]",function(){$(this).closest("tr").find("input[type=checkbox]").prop("checked",true).trigger("change")}).on("click",".deviceDataRow input[type=checkbox]",function(){var F=0;var E=$(this).closest("table").attr("id");$(this).closest("table").find(".macItems input[type=checkbox]:not(:checked)").each(function(){if($(this).parent().parent().attr("id")!=="newMacAddress"){F++;$("#"+E+" .checkboxAllDevices").prop("checked",false)}});if(F===0){$("#"+E+" .checkboxAllDevices").prop("checked",true)}if($(this).closest("table").attr("id")==="tblMacSettings"){f(F===0)}else{z()}}).on("click","#macSettingsAuthorisedDevices",function(){$("#tabA").show()}).on("click","#macSettingsUnauthorisedDevices",function(){$("#tabB").show()})}function p(){VendorWifi.GetMacSettings({},u);r();g();a()}$.extend(this,{name:"mac-settings",menuName:"TR_MAC_FILTERING",views:["desktopView"],requiresLoggedIn:true,isMobileWifi:true,parent:"wifi-settings",doSpecificStuff:p,WhiteBlackListLimit:w,renderLayout:layout.threeColumn})}function natsettings(){var m;var r=-1;function s(w){$(".showHideForm").toggle(w);if(device.supportedFeatures.NATTYPES!=="both"){$("#natTypeSelection").hide()}}function l(){if(m===undefined){return}b(m.natEnabled);n(m.natType);s(m.natEnabled);v();page.dataReceived();throbber.hide();d()}function d(){o("natSettingsApplicationName");o("natSettingsSourcePort");o("natSettingsDestinationIP");o("natSettingsDestinationPort")}function o(w){$("#"+w+"Placeholder").focusin(function(){$("#"+w+"Placeholder").hide();$("#"+w).show().focus()})}function h(){f("natSettingsApplicationName");f("natSettingsSourcePort");f("natSettingsDestinationIP");f("natSettingsDestinationPort")}function f(w){$("#"+w+"Placeholder").hide();$("#"+w).show()}function j(w){m=w;l()}function t(w){UserNotification.showGenericVendorResponse(true);j(w)}function v(){$("#applicationMapTable").empty();var w=true;$.each(m.portMappings,function(y,z){var x={isOdd:w,applicationName:z.applicationName,applicationProtocol:z.applicationProtocol,sourcePort:z.sourcePort,destinationIp:z.destinationIp,destinationPort:z.destinationPort,itemIndex:y};$.tmpl(HTMLTemplates.applicationMap,x).appendTo("#applicationMapTable");w=!w});$("#applicationMapTable *").translateElements();q()}function g(){if(r>-1){m.portMappings=$.grep(m.portMappings,function(x,w){return w!==r});r=-1}}function e(){h();if(!UserNotification.formValidated()){throbber.hide();return}g();$("#natSettingsAddMap span").removeClass().setTranslation("TR_ADD");var x={applicationName:$("#natSettingsApplicationName").val(),applicationProtocol:$("#natSettingsProtocolDropdown").val(),sourcePort:$("#natSettingsSourcePort").val(),destinationIp:$("#natSettingsDestinationIP").val(),destinationPort:$("#natSettingsDestinationPort").val()};for(i=0;i<m.portMappings.length;i++){if(String(m.portMappings[i].sourcePort)===x.sourcePort){var w={error:true,hintTitleTr:"TR_NAT_SETTINGS_DUPLICATE_MAC_ADDRESS_TITLE",hintTextTr:"TR_NAT_SETTINGS_DUPLICATE_MAC_ADDRESS_TEXT"};UserNotification.showResponse(w);throbber.hide();return}}m.portMappings.push(x);$(".formfield").val("");v();throbber.hide()}function u(){$("#addCustomApplication").show();r=$(this).closest("tr").index();var w=m.portMappings;$("#natSettingsAddMap span").removeClass().setTranslation("TR_UPDATE");h();$("#natSettingsApplicationName").val(w[r].applicationName);$("#natSettingsProtocolDropdown").val(w[r].applicationProtocol);$("#natSettingsSourcePort").val(w[r].sourcePort);$("#natSettingsDestinationIP").val(w[r].destinationIp);$("#natSettingsDestinationPort").val(w[r].destinationPort)}function p(){r=$(this).closest("tr").index();g();v()}function c(){function w(){UserNotification.showGenericVendorResponse(false);throbber.hide()}$.extend(m,{natEnabled:$("#frmNatSettings").find(".natServerEnabledtrue").prop("checked"),natType:$("#frmNatSettings").find(".natTypeSymmetric").prop("checked")?"symmetric":"cone"});throbber.show();VendorWifi.SetNatSettings(m,function(){VendorWifi.GetNatSettings({},t,w)},w)}function q(){if(m.portMappings.length>15||!$(".natServerEnabledtrue").prop("checked")){$("#addCustomApplication").hide()}else{$("#addCustomApplication").show()}}function a(){$("#mainContent").on("change","#frmNatSettings *[name=natServerEnabled]",function(){s($(".natServerEnabledtrue").prop("checked"));q()}).on("click","#natSettingsSaveBtn",c).on("click",".changeBtn",u).on("click",".deleteBtn",p);$("#natSettingsAddMap").setButtonAction(e);$("#natSettingsSourcePort, #natSettingsDestinationPort").off().on("keypress",function(w){UserNotification.allowOnlyNumbersAndClipboardActions(w)}).on("paste",function(){var x=$(this);var w=x.val();x.css("color","white");setTimeout(function(){if(!UserNotification.validation.validatePort(x.val())){x.val(w)}x.css("color","#333")},0)})}function b(w){$("#frmNatSettings").find(".natServerEnabled"+w.toString()).prop("checked",true)}function n(w){if(w==="symmetric"){$("#frmNatSettings").find(".natTypeSymmetric").prop("checked",true)}else{$("#frmNatSettings").find(".natTypeCone").prop("checked",true)}}function k(){VendorWifi.GetNatSettings({},j);a()}$.extend(this,{views:["desktopView"],doSpecificStuff:k,name:"nat-settings",parent:"router-settings",menuName:"TR_NAT_SETTINGS",requiresLoggedIn:true,isMobileWifi:true,renderLayout:layout.threeColumn})}function routersettings(){function f(){$("#routerPasswordOld").val("");$("#routerPasswordNew").val("");$("#routerPasswordConfirm").val("")}function c(){function h(){device.routerSettings=$.extend(device.routerSettings,k);VendorWifi.GetDmzSettings({},function(l){if(l.dmzEnabled){l.dmzEnabled=false;VendorWifi.SetDmzSettings(l,function(){UserNotification.showResponse({hintTextTr:"ROUTER_SETTINGS_CHANGED_NO_DMZ_DHCP_UPDATES_REQUIRED"})})}else{UserNotification.showResponse({hintTextTr:"ROUTER_SETTINGS_CHANGED_NO_DMZ_DHCP_UPDATES_REQUIRED"})}});throbber.hide()}function j(l){throbber.hide();UserNotification.showGenericVendorResponse(false,{hintTextTr:"TR_ERROR_TITLE_GENERIC"})}var k=device.routerSettings;var g=$("#frmRouterSettings").find(".dhcpEnabledtrue").prop("checked");$.extend(k,{lanIpAddress:$("#routerIPAddress").val(),subnetMask:$("#routerSubnetMask").val(),lanDomainName:$("#routerLANDomain").val(),switchBatteryOffWhenIdle:$("#routerBatteryIdle").prop("checked"),dhcpEnabled:g});if(g){$.extend(k,{dhcpRangeStart:$("#dhcpIPRangeStart").val(),dhcpRangeEnd:$("#dhcpIPRangeEnd").val(),dhcpLeaseTime:$("#dhcpLeaseType").val()})}if(!UserNotification.subFormValidated($("#fieldsetRouterSettings1"))){return}VendorWifi.SetRouterIpConfiguration(k,h,j)}function d(){var g={oldPassword:$("#routerPasswordOld").val(),newPassword:$("#routerPasswordNew").val()};if(!UserNotification.subFormValidated($("#fieldsetRouterSettings2"))){return}VendorWifi.ChangePassword(g,function(){f();UserNotification.showSuccessResponse();throbber.hide()},function(h){throbber.hide();if(h.errorType==="badPassword"){UserNotification.showGenericVendorResponse(false,{hintTextTr:"TR_INCORRECT_PASSWORD"});$("#routerPasswordOld, label[for=routerPasswordOld]").addClass("error")}else{UserNotification.showGenericVendorResponse(false)}})}function e(){$("#routerSettingsSaveBtn").setButtonAction(c,"#fieldsetRouterSettings1");$("#routerSettingsPasswordSaveBtn").setButtonAction(d,"#fieldsetRouterSettings2");$("#mainContent").on("change","#frmRouterSettings *[name=dhcpEnabled]",function(){$(".showHideForm").toggle($(this).val())})}function b(){UserNotification.validation.validateChangePassword=function(g){if($("#routerPasswordConfirm").val()!==""){$("#routerPasswordConfirm").trigger("blur")}return UserNotification.validation.validatePassword(g)};UserNotification.validation.validateConfirmPassword=function(g){return $("#routerPasswordNew").val()===$("#routerPasswordConfirm").val()};UserNotification.validation.validateDhcpAddressStart=function(j){function k(){if(h&&h.subnetIpRangeStart&&h.subnetIpRangeEnd){var m=Util.convertIpAddressToNumber(h.subnetIpRangeEnd)>Util.convertIpAddressToNumber(g.dhcpRangeStart);var l=Util.convertIpAddressToNumber(h.subnetIpRangeStart)<=Util.convertIpAddressToNumber(g.dhcpRangeStart);var n=Util.convertIpAddressToNumber(g.dhcpRangeStart)<Util.convertIpAddressToNumber(g.dhcpRangeEnd);return m&&l&&n}else{return false}}var g=$.extend({},device.routerSettings);$.extend(g,{lanIpAddress:$("#routerIPAddress").val(),subnetMask:$("#routerSubnetMask").val(),lanDomainName:$("#routerLANDomain").val(),switchBatteryOffWhenIdle:$("#routerBatteryIdle").prop("checked"),dhcpEnabled:$("#frmRouterSettings").find(".dhcpEnabledtrue").prop("checked"),dhcpRangeStart:$("#dhcpIPRangeStart").val(),dhcpRangeEnd:$("#dhcpIPRangeEnd").val(),dhcpLeaseTime:$("#dhcpLeaseType").val()});var h=Util.getSubnetIpRange(g);if(k()){return true}return false};UserNotification.validation.validateDhcpAddressEnd=function(j){function k(){if(h&&h.subnetIpRangeStart&&h.subnetIpRangeEnd){var m=Util.convertIpAddressToNumber(h.subnetIpRangeEnd)>=Util.convertIpAddressToNumber(g.dhcpRangeEnd);var l=Util.convertIpAddressToNumber(h.subnetIpRangeStart)<Util.convertIpAddressToNumber(g.dhcpRangeEnd);var n=Util.convertIpAddressToNumber(g.dhcpRangeStart)<Util.convertIpAddressToNumber(g.dhcpRangeEnd);return m&&l&&n}else{return false}}var g=$.extend({},device.routerSettings);$.extend(g,{lanIpAddress:$("#routerIPAddress").val(),subnetMask:$("#routerSubnetMask").val(),lanDomainName:$("#routerLANDomain").val(),switchBatteryOffWhenIdle:$("#routerBatteryIdle").prop("checked"),dhcpEnabled:$("#frmRouterSettings").find(".dhcpEnabledtrue").prop("checked"),dhcpRangeStart:$("#dhcpIPRangeStart").val(),dhcpRangeEnd:$("#dhcpIPRangeEnd").val(),dhcpLeaseTime:$("#dhcpLeaseType").val()});var h=Util.getSubnetIpRange(g);if(k()){return true}return false}}function a(){b();f();var g=device.routerSettings;$("#routerIPAddress").val(g.lanIpAddress);$("#routerSubnetMask").val(g.subnetMask);$("#routerLANDomain").val(g.lanDomainName);if(g.switchBatteryOffWhenIdle){$("#routerBatteryIdle").prop("checked",g.switchBatteryOffWhenIdle)}function h(j){$("#frmRouterSettings").find(".dhcpEnabled"+j.toString()).prop("checked",true)}h(g.dhcpEnabled);$("#dhcpIPRangeStart").val(g.dhcpRangeStart);$("#dhcpIPRangeEnd").val(g.dhcpRangeEnd);$("#dhcpLeaseType").val(g.dhcpLeaseTime);$(".showHideForm").toggle(g.dhcpEnabled);throbber.hide();e();page.dataReceived()}$.extend(this,{views:["desktopView"],renderLayout:layout.threeColumn,doSpecificStuff:a,name:"router-settings",parent:"welcome",children:["router-settings","nat-settings","dmz-settings","advanced-settings"],menuName:"TR_ROUTER_SETTINGS",isMobileWifi:true,requiresLoggedIn:true})}function securitysettings(){var l;var e;var d;var f=["AUTO","NONE","SHARE","OPEN"];function a(s){return $.inArray(s.toUpperCase(),f)===-1?s:languageManager["TR_"+s.toUpperCase()]}function r(){$("#authenticationModeSelect").change(function(){var s=l.validAuthenticationModes[$("#authenticationModeSelect option:selected").index()];b(s);if(s.authenticationMode==="NONE"){$("#encryptionKeyLabel").hide();$("#encryptionKey").hide();$("#encryptionsBlock").hide()}else{$("#encryptionKeyLabel").show();$("#encryptionKey").show();$("#encryptionsBlock").show()}});$("#authenticationModeSelect >option").remove();$.each(l.validAuthenticationModes,function(t,u){var s=$.inArray(u.authenticationMode,f)===-1?"":' class="TR_'+u.authenticationMode.toUpperCase()+'"';$("#authenticationModeSelect").append($("<option"+s+"></option>").val(u.authenticationMode).html(n(u)))});if(l.authenticationMode==="NONE"){$("#encryptionKeyLabel").hide();$("#encryptionKey").hide();$("#encryptionsBlock").hide()}else{$("#encryptionKeyLabel").show();$("#encryptionKey").show();$("#encryptionsBlock").show()}$("#authenticationModeSelect").val(l.authenticationMode);$("#authenticationMobile").html(l.authenticationMode)}function b(s){if(s.authenticationMode!=="NONE"){$("#encryptionTypeSelect >option").remove();$.each(s.validEncryptionTypes,function(u,v){var t=$.inArray(v.toUpperCase(),f)===-1?"":' class="TR_'+v.toUpperCase()+'"';$("#encryptionTypeSelect").append($("<option"+t+"></option>").val(v).html(a(v)))});$("#encryptionTypeSelect").val(l.encryptionType);$("#encTypeMobile").html(l.encryptionType)}}function n(s){if(s.authenticationMode===l.authenticationMode){b(s)}return a(s.authenticationMode)}function m(){if(e===undefined||l===undefined){return}clearInterval(d);$("#ssidField").val(e.ssid);$("#ssidFieldMobile").html(e.ssid);if(l.authenticationMode==="NONE"){$("#encryptionKeyLabel").hide();$("#encryptionKey").hide();$("#encryptionsBlock").hide()}$("#encryptionKey").val(l.encryptionKey);r();c(l.authenticationMode);$("#wifiEnabled").show();throbber.hide();page.dataReceived()}function p(s){l=s;m()}function q(s){e=s;m()}function k(){l=e=undefined;VendorWifi.GetWifiSecuritySettings({},p);VendorWifi.GetWifiSettings({},q)}function c(s){UserNotification.validation.validateEncryptionKeyByType=function(t){return UserNotification.validation.validateEncryptionKey(t,s)}}function j(){VendorWifi.SetWifiSecuritySettings(l,function(){$("#securitySettingsSaveBtn").removeClass("disabled");UserNotification.showSuccessResponse()},function(){$("#securitySettingsSaveBtn").removeClass("disabled");UserNotification.showGenericVendorResponse(false,{hintTextTr:"TR_PLEASE_TRY_LATER"})});VendorWifi.SetWifiSettings(e,function(){UserNotification.showSuccessResponse()},function(){UserNotification.showGenericVendorResponse(false,{hintTextTr:"TR_PLEASE_TRY_LATER"})});d=setInterval(k,15000)}function h(){$("#securitySettingsSaveBtn").addClass("disabled");var t=e.ssid;$.extend(l,{encryptionKey:$("#encryptionKey").val(),encryptionType:l.validAuthenticationModes[$("#authenticationModeSelect option:selected").index()].validEncryptionTypes[$("#encryptionTypeSelect option:selected").index()],authenticationMode:l.validAuthenticationModes[$("#authenticationModeSelect option:selected").index()].authenticationMode});if($("#ssidField").val()!==t){var s={button1TrClass:"ERROR_OK",button2TrClass:"TR_ERROR_CANCEL",titleTrClass:"TR_CONFIRM_SSID_TITLE",messageTrClass:"TR_CONFIRM_SSID_TEXT"};UserNotification.showPrompt(function(u){if(u){$.extend(e,{ssid:$("#ssidField").val()});j()}else{$("#securitySettingsSaveBtn").removeClass("disabled")}},s)}else{j()}}function o(){$("#mainContent").on("change","#authenticationModeSelect",function(){c($(this).val());$("#encryptionKey").blur()});$("#securitySettingsSaveBtn").setButtonAction(h)}function g(){VendorWifi.GetWifiSecuritySettings({},p);VendorWifi.GetWifiSettings({},q);o()}$.extend(this,{doSpecificStuff:g,name:"security-settings",parent:"wifi-settings",menuName:"TR_WIFI_SECURITY_TITLE",isMobileWifi:true,requiresLoggedIn:true,renderLayout:layout.threeColumn,backButton:"wifi-mobile"})}function wifimobile(){$.extend(this,{views:["mobileView"],name:"wifi-mobile",menuName:"TR_WIFI",children:["wifi-settings","security-settings","wps-settings"],backButton:"home-mobile",requiresLoggedIn:true})}function wifisettings(){var e=null;var j=["b/g/n","a/b/g/n","a","a/n","a/g/n","a/g"];var q=true;var s="0";function w(C){var D=[],E;for(E in C){if(C.hasOwnProperty(E)){D.push(parseInt(E,10))}}return D}function n(H,D){var F=[],C,G,E;for(C in D){if(D.hasOwnProperty(C)){if(C===H){for(E=0;E<D[C].length;E++){for(G in D[C][E]){if(D[C][E].hasOwnProperty(G)){F.push(G)}}}break}}}return F}function B(G,D){var F,E,C;for(F in D){if(D.hasOwnProperty(F)){for(E=0;E<D[F].length;E++){for(C in D[F][E]){if(D[F][E].hasOwnProperty(C)){if(C===G){return D[F][E][G]}}}}}}}function p(){d();c()}function v(){var C=VendorWifi.GetWifiInformation();if(device.supportedFeatures.WIFIBAND5GHZ){r(C)}t(C);u(C)}function l(C){a(C);e=$.extend(e,C);x(e.wifiEnabled);y(e.broadcastSsidEnabled);o(e.showSsidOnDeviceEnabled);$("#wifiEnabled").show();if(device.supportedFeatures.VendorAPISupport>=1.47){v()}else{p()}if(!device.supportedFeatures.WIFIBAND5GHZ){$("#supportedBands").remove()}page.dataReceived()}function f(){$.extend(e,{wifiEnabled:$("#wifiEnabled").find(".wifiEnabledtrue").prop("checked"),broadcastSsidEnabled:$("#broadcastSSIDEnabled").find(".broadcastSSIDEnabledtrue").prop("checked"),showSsidOnDeviceEnabled:$("#showSSIDEnabled").find(".showSSIDEnabledtrue").prop("checked"),selectedChannel:$("#wifiChannelSelect").val(),wifiMode:$("#wifiLeaseType").val()},(device.supportedFeatures.WIFIBAND5GHZ)?{supportedBand:$("#wifiBand").val()}:{});VendorWifi.SetWifiSettings(e,function(){UserNotification.showSuccessResponse();VendorWifi.GetWifiSettings({},l);throbber.hide()},function(){UserNotification.showGenericVendorResponse(false,{hintTextTr:"TR_PLEASE_TRY_LATER"});VendorWifi.GetWifiSettings({},l);throbber.hide()})}function g(D,C){$.each(D,function(E,F){C.push({name:F,value:F})})}function A(C){return C===0?"TR_WIFI_BAND_AUTO":C===1?"TR_WIFI_BAND_G":"TR_WIFI_BAND_N"}function r(C){$("#wifiBand").empty();var E=w(C),D=[];$.each(E,function(F,G){D.push({name:G,value:G,clazz:A(G)})});$.tmpl(HTMLTemplates.htmlOption,D).appendTo("#wifiBand");$("#wifiBand").val(e.supportedBand)}function d(){$("#wifiLeaseType").empty();var C=[];g(e.supportedModes,C);$.tmpl(HTMLTemplates.htmlOption,C).appendTo("#wifiLeaseType");$("#wifiLeaseType").val(e.wifiMode);$("#wifiLeaseTypeView").html(e.wifiMode);$("#wifiBand").val(e.supportedBand)}function t(D,C){$("#wifiLeaseType").empty();var F=n(C?C:e.supportedBand,D),E=[];g(F,E);$.tmpl(HTMLTemplates.htmlOption,E).appendTo("#wifiLeaseType");$("#wifiLeaseType").val(C?0:e.wifiMode)}function u(E,D){$("#wifiChannelSelect").empty();var C=B(D?D:e.wifiMode,E),F=[];F.push({name:languageManager.AUTOMATIC,value:0,clazz:"AUTOMATIC"});g(C,F);$.tmpl(HTMLTemplates.htmlOption,F).appendTo("#wifiChannelSelect");$("#wifiChannelSelect").val(D?0:e.selectedChannel)}function h(){var H=VendorWifi.GetParameterValidation().maxWifiChannel;$("#wifiChannelSelect").empty();var I=$("#wifiBand").val()==="2";var E=$("#wifiBand").val()==="0";var D=[],G=I?48:H,F=I?32:0,C=I?4:1;for(;F<=G;F+=C){D.push({clazz:F===0||F===32?"AUTOMATIC":"",name:F===0||F===32?languageManager.AUTOMATIC:F,value:F});if(F===H&&E){F=32;G=48;C=4}}$.tmpl(HTMLTemplates.htmlOption,D).appendTo("#wifiChannelSelect");$("#wifiChannelSelect").val(e.selectedChannel);$("#wifiChannelSelectView").html(e.selectedChannel)}function x(C){$("#wifiEnabled").find(".wifiEnabled"+C.toString()).prop("checked",true)}function y(C){$("#broadcastSSIDEnabled").find(".broadcastSSIDEnabled"+C.toString()).prop("checked",true)}function o(C){$("#showSSIDEnabled").find(".showSSIDEnabled"+C.toString()).prop("checked",true)}function c(){if($.inArray($("#wifiLeaseType").val(),j)!==-1){switch(s){case"0":$("#wifiBand").removeAttr("disabled");$("#wifiBand").selectMenu("enable");$("#wifiBand").val(e.supportedBand);break;case"1":case"2":$("#wifiBand").removeAttr("disabled");$("#wifiBand").selectMenu("enable");$('#wifiBand option[value="0"]').remove();break;default:$("#wifiBand").attr("disabled","true");$("#wifiBand").val("1")}}else{$("#wifiBand").attr("disabled","true");$("#wifiBand").selectMenu("disable");$("#wifiBand").val("1")}h();$("#wifiBand").selectMenu("refresh")}function m(){var C=$("#wifiBand").val();t(VendorWifi.GetWifiInformation(),C);z()}function z(){var C=$("#wifiLeaseType").val();u(VendorWifi.GetWifiInformation(),C)}function b(){if(!device.supportedFeatures.VendorAPISupport||device.supportedFeatures.VendorAPISupport<1.47){$("#wifiLeaseType").on("change",c);$("#supportedBands").on("change",h)}else{$("#wifiBand").on("change",m);$("#wifiLeaseType").on("change",z)}$("#wifiSettingsSaveBtn").setButtonAction(f)}function a(){q=device.supportedFeatures.WIFIBAND5GHZ;s=device.supportedFeatures.WIFIMODESWITCHING}function k(){e={showSsidOnDeviceEnabled:true,supportedBand:"1"};VendorWifi.GetWifiSettings({},l);b()}$.extend(this,{doSpecificStuff:k,name:"wifi-settings",parent:"welcome",menuName:"TR_WIFI_SETTINGS",isMobileWifi:true,children:["wifi-settings","mac-settings","security-settings","wps-settings"],requiresLoggedIn:true,renderLayout:layout.threeColumn,backButton:"wifi-mobile"},(typeof testing==="boolean"&&testing)?{getBands:w,getModes:n,getChannels:B,getTranslationForBand:A,wifiSettings:function(){return e}}:{})}function wpssettings(){var k={};function g(){var l=$("#wpsEnabledRadio1").prop("checked");var m=SupportedFeatures();if(m.WPSPIN&&m.WPSPUSH){$("#wpsSettingsHelpCol1Paragraph1").setTranslation("TR_WPS_HELP_PARAGRAPH_1")}else{if(!m.WPSPUSH){$("#wpsSettingsHelpCol1Paragraph1").setTranslation("TR_WPS_HELP_PARAGRAPH_1_PIN")}else{$("#wpsSettingsHelpCol1Paragraph1").setTranslation("TR_WPS_HELP_PARAGRAPH_1_PUSH")}}$(".showHideForm").toggle(l);$("#wpsPinSettings").toggle(m.WPSPIN)}function c(l,m){throbber.hide();UserNotification.showGenericVendorResponse(l,m)}function b(){var l=$("#wifiSettingsSaveBtn");l.removeClass("buttonGreen").addClass("disabled buttonLight");l.unbind("click")}function a(){var l=$("#wifiSettingsSaveBtn");l.unbind("click");l.removeClass("disabled buttonLight").addClass("buttonGreen");l.setButtonAction(j)}function j(){k.wpsEnabled=$("#wpsEnabledRadio1").prop("checked");k.wpsPin=$("#wpsPin").val();k.setByWps=$("#setByWPS").prop("checked");if(typeof VendorWifi.SetWpsSettings==="function"){VendorWifi.SetWpsSettings(k,function(){c(true);b()},function(){c(false,{hintTextTr:"TR_PLEASE_TRY_LATER"});b()})}}function d(){$("body").on("change","input:radio[name=wpsEnabled]",function(){g();a()}).on("change","input:radio[name=wpsSettings]",function(){a()}).on("click",".wpsSettingsNewPinBtn",function(){$("#wpsPin").val(VendorWifi.GenerateNewWpsPin());a()}).on("keydown, paste, input","#wpsPin",function(){a()})}function e(l){k=l;$(".wpsEnabled"+k.wpsEnabled).prop("checked",true);$(document).on("page.complete",function(){g()});$("#wpsPin").val(k.wpsPin);$(".wpsSettings"+k.setByWps).attr("checked",true);page.dataReceived()}function f(){var m=$(".setByWps > input");var l=$("#setByWpsDropdown").val();if(l===languageManager.TR_RECONFIGURE_SSID_AND_KEY){m.filter("[id=networkSettings4gPref]").attr("checked",true).trigger("mousedown")}switch(l){case TagSubstitution.substituteText(languageManager.TR_RECONFIGURE_SSID_AND_KEY):m.filter("[id=networkSettings4gPref]").attr("checked",true).trigger("mousedown");break;case TagSubstitution.substituteText(languageManager.FOURG):m.filter("[id=networkSettings4g]").attr("checked",true).trigger("mousedown");break;case TagSubstitution.substituteText(languageManager.THREEG_PREFERRED):m.filter("[id=networkSettings3gPref]").attr("checked",true).trigger("mousedown");break;case TagSubstitution.substituteText(languageManager.THREEG):m.filter("[id=networkSettings3g]").attr("checked",true).trigger("mousedown");break;case TagSubstitution.substituteText(languageManager.GPRS_ONLY):m.filter("[id=networkSettingsGPRS]").attr("checked",true).trigger("mousedown");break}}function h(){if(typeof VendorWifi.GetWpsSettings==="function"){VendorWifi.GetWpsSettings({},e,function(){})}else{e({wpsEnabled:true,wpsPin:12345678,setByWPS:true})}d()}$.extend(this,{doSpecificStuff:h,name:"wps-settings",parent:"wifi-settings",menuName:"TR_WIFI_WPS_SETTINGS",requiresLoggedIn:true,isMobileWifi:true,isWps:true,renderLayout:layout.threeColumn,backButton:"wifi-mobile",setByWps:f})}function diagnostics(){function g(){var h=WiFiShared.getConnectedDevices();$("#attachedDevices").empty();if(h){var j=new formatting.ConvertTime();$.each(h,function(l,m){var k={ipAddress:m.ipAddress,hostName:m.hostName,macAddress:m.macAddress,timeConnected:j.secondsToHHMMSS(m.timeConnected)};$.tmpl(HTMLTemplates.attachedDeviceDiagnosticItem,k).appendTo("#attachedDevices")})}}function e(){var h={button1TrClass:"YES_BTN",button2TrClass:"NO_BTN",titleTrClass:"CONFIRM_TIME_RESET",messageTrClass:"CONFIRM_POPUP"};UserNotification.showPrompt(function(j){if(j){ResetDataCounter(d)}},h)}function b(){g(WiFiShared.getConnectedDevices())}function c(){var h=VendorWifi.GetWifiSettings();$("#wifiMode").html(h.wifiMode);if(h.selectedChannel==="0"){$("#wifiChannel").html("");$("#wifiChannel").setTranslation("AUTOMATIC")}else{$("#wifiChannel").html(h.selectedChannel);$("#wifiChannel").removeClass("AUTOMATIC")}}function d(){function l(){function n(o,p){function r(s,t){if(s){switch(t){case"IPv4":$("#IPAddress").html(p.IPv4);break;case"IPv6":$(".ipv4").hide();$(".ipv6").show();$("#IPv6Address").html(p.IPv6);break;case"IPv4 + IPv6":$(".ipv6").show();$("#IPAddress").html(p.IPv4);$("#IPv6Address").html(p.IPv6);break}}}if(o){if(typeof p==="object"&&typeof GetIPType==="function"&&device.supportedFeatures.hasOwnProperty("IPVersionSupport")){GetIPType(r)}else{var q=(typeof p==="string")?p:p.IPv4;$("#IPAddress").html(q)}}}GetIPAddress(n)}function k(){var n=GetCustomAccountType();if(n!==null){$("#dns2").html(n.strDNS2)}}function h(n){if(typeof n==="string"){$("#dns").html(n);k()}else{if(typeof n==="object"){$("#dns").html(n.dns1);$("#dns2").html(n.dns2);if(typeof n.dnsIPv61==="string"&&typeof n.dnsIPv62==="string"){$("#dnsIPv6").html(n.dnsIPv61);$("#dns2Ipv6").html(n.dnsIPv62)}}}}function j(){function n(o,p){if(o){h(p)}}GetDNS(n)}function m(o){var n="";switch(o){case 1:n="TR_READY";break;case 2:n="TR_NO_SIM_OR_INVALID_CARD";break;case 3:n="PIN_REQUIRED";break;case 4:n="PUK_IS_REQUIRED";break;default:break}$("#simStatus").setTranslation(n)}$("#productName").html(GetProductName());$("#softwareVersion").html(GetSoftwareVersion());$("#webUIVersion").html(productInfo.getWebUIVersion());$("#hardwareVersion").html(GetHWVersion());$("#serialNumber").html(GetSerialNumber());$("#simSerialNumber").html(GetSimSerialNumber());$("#phoneNumber").html(PhoneNumber.getNumber());if(device.supportedFeatures.VendorAPISupport>1.47){$("#IMEI").html(GetIMEI()+" / "+GetIMEIsv())}else{$("#IMEI").html(GetIMEI())}$("#IMSI").html(imsi);m(simInfo.simCardStatus().nSimState);l();j()}function f(){$(document).on("click","#helpDiagnosticsResetBtn",e);$(document).on("page.postLoadHTML."+pageLoader.getCurrentEventNamespace(),function(){var h=productInfo.isMobileWifi()?"CONNECTING_HELP_TEXT2":"";$("#helpDiagnosticsCol3Paragraph1").setTranslation(h);if(urlParams.expand==="status"){$("#helpDiagnosticsAccordionTitle2").scrollToMe().removeClass().addClass("expand");$(document).trigger("click","#helpDiagnosticsAccordionContent2");$(document).trigger("touchstart","#helpDiagnosticsAccordionContent2")}});$(document).trigger("diagnosticsHtmlLoaded")}function a(){f();if(!productInfo.isMobileWifi()){$(".mobilewifi").hide()}d();ConnectionManager.setPageConnectionStatusUpdateFunction(function(h){if(h.connectionTextTr){$("#connectionState").attr("class","amount").setTranslation(h.connectionTextTr)}});b();c();$(document).on("connectedDevices.updated."+pageLoader.getCurrentEventNamespace(),g);$(document).on("page.postLoadHTML."+pageLoader.getCurrentEventNamespace(),function(){if(urlParams.expand==="status"){$("#helpDiagnosticsAccordionTitleMobile2 a").scrollToMe().trigger("click");if($.browser.msie&&$.browser.version==="6.0"){$("#helpDiagnosticsAccordionTitleMobile2 a").click()}}});page.dataReceived()}this.updateCurrentlyAttachedDevices=b;$.extend(this,{name:"diagnostics",menuName:"DIAGNOSTICS",parent:"help",renderLayout:layout.threeColumn,backButton:"help-mobile",requiresLoggedIn:true,doSpecificStuff:a})}function devicecontrols(){function b(){var e=$("input[name=deviceControl]:checked");if(e.val()==="rebootDevice"){d()}else{if(e.val()==="factorySettings"){c()}}}function d(){var e={button1TrClass:"ERROR_OK",button2TrClass:"TR_ERROR_CANCEL",titleTrClass:"REBOOT_THE_DEVICE",messageTrClass:""};var g=RebootDevice;function f(h){if(h){ConnectionManager.setDeviceRebooting(true);throbber.show();g()}}UserNotification.showPrompt(f,e)}function c(){var e={titleTrClass:"FACTORY_SETTINGS",messageTrClass:"WARNING_MESSAGE",button1TrClass:"ERROR_OK",button2TrClass:"TR_ERROR_CANCEL"};function h(){throbber.show();$("#throbberText").setTranslation(languageManager.DEVICE_REBOOTING);RestoreFactorySettings(function(j){if(!j){throbber.hide()}})}var g=h;function f(j){if(j){ConnectionManager.setDeviceRebooting(true);g()}}UserNotification.showPrompt(f,e)}function a(){$("body").on("click","#deviceControlsRebootBtn",d).on("click","#deviceControlsRestoreBtn",c).on("click","#deviceControlsConfirmBtn",b);page.dataReceived()}$.extend(this,{name:"deviceControls",menuName:"DEVICE_CONTROLS",backButton:"help-mobile",requiresLoggedIn:true,renderLayout:layout.threeColumn,parent:"help",doSpecificStuff:a})}function about(){function a(){page.dataReceived()}$.extend(this,{doSpecificStuff:a,name:"about",menuName:"ABOUT",parent:"help",renderLayout:layout.threeColumn,backButton:"help-mobile"})}function help(){function h(r){var p=$("#"+r);if(p.length===0){p=$("#"+r.replace("Accordion","Accordian"))}var q=p.closest("li").find("h3");p.toggle();q.toggleClass("accordionOpen accordionClosed")}function n(){if(urlParams&&urlParams.context&&urlParams.context==="Account"){$('a[topic="SMS"]').attr("topic","Account");$("#smsContextHelpTitle").html("<a class='ACCOUNT_HELP' topic=\"Account\">"+languageManager.ACCOUNT_HELP+"</a>");$("#helpBoxTwoParagraph1").html("<span id='HELP_TOPIC_HELP_FOR_MAVTSOYA' class='HELP_TOPIC_HELP_FOR_MAVTSOYA'></span>");$("#helpQuestionCol2ViewAll").parent().html('<a id="helpQuestionCol1ViewAll" class=\'HELP_TOPIC_VIEW_ALL_AHAT\' topic="AccountTopics">'+languageManager.HELP_TOPIC_VIEW_ALL_AHAT+"</a>");$("#helpBoxTwoLink").html("<a class='HELP_TOPIC_VIEW_ALL_AHT' topic=\"Account\">"+languageManager.HELP_TOPIC_VIEW_ALL_AHT+"</a>");$("#helpQuestionCol2Item1").html("<a class='hideForItaly hideForEgypt ACCOUNT_TYPE' topic=\"AccountTopicAccountType\">"+languageManager.HELPTOPIC_ACCOUNT_TYPE_373+"</a>");$("#helpQuestionCol2Item2").html("<a class='AD_ACCOUNT_DETAILS' topic=\"AccountTopicAccountDetails\">"+languageManager.AD_ACCOUNT_DETAILS+"</a>");$("#helpQuestionCol2Item3").html("<a class='hideForItaly hideForGreece BALANCE_HELP' topic=\"AccountTopicBalance\">"+languageManager.BALANCE_HELP+"</a>");$("#helpQuestionCol2Item4").html("<a class='hideForItaly hideForGreece TOP_UP_HELP' topic=\"AccountTopicTopup\">"+languageManager.TOP_UP_HELP+"</a>");$("#helpQuestionCol2Item5").html("<a class='ACCOUNT_HELP' topic=\"AccountTopicHelp\">"+languageManager._HELP+"</a>")}else{$("#smsContextHelpTitle").html("<a class='INBOX_HELPTITLE' topic=\"SMS\">"+languageManager.INBOX_HELPTITLE+"</a>")}}function d(){if(!productInfo.isWifiStick()){return}$(".TR_BATTERY_STATUS_WIFI_STATUS_").setTranslation("TR_BATTERY_STATUS_WIFI_STATUS_NoBattery");$(".TR__RED_CROSS_SYMBOL__WIFI_IS_").setTranslation("TR__RED_CROSS_SYMBOL__WIFI_IS_NoBattery");$(".TR_OFF__WIFI_IS_SWITCHED_OFF_O").setTranslation("TR_OFF__WIFI_IS_SWITCHED_OFF_O_NoBattery")}function g(){a();l();o();f()}function f(){}function o(){if(OpCo.country!=="Portugal"){return}$(".INBOX_HELPTITLE").setTranslation("SIM_PIN_HELP_PORTUGAL_OPCO")}function a(){if(OpCo.country!=="Australia"){return}else{$("#AccountTopicBalance").hide();$("#AccountBalance").hide();$("#balanceHelp").hide();$(".HELPTOPIC_TO_ADD_CREDIT_TO_YOU_119").setTranslation("HELPTOPIC_RECHARGE_CREDIT_CONTENT_MobileWifi");$(".HELPTOPIC_IF_YOU_HAVE_PURCHASE_117").setTranslation("HELPTOPIC_RECHARGE_VOUCHER_CONTENT_MobileWifi");if(urlParams.context==="Account"){$("#helpQuestionCol2Item3").hide();$("#helpQuestionCol2ViewAll").css("marginTop","30px")}}}function l(){if(OpCo.country!=="Italy"){return}else{$(".TR_WHEN_YOU_SELECT_THE_SMS_NAV, .TR_IF_YOUR_MOBILE_NETWORK_OPER, .TR_WHEN_YOU_ARE_ROAMING_ON_A_M, .TR_WHEN_YOU_ARE_ROAMING_THE_ST").hide()}}function k(){if((typeof device.supportedFeatures==="object")&&(typeof device.supportedFeatures.LTE==="boolean")&&device.supportedFeatures.LTE){$(".HELPTOPIC_QUICKSTART_SETTINGS_STATUS_BEARER_2").setTranslation("HELPTOPIC_QUICKSTART_SETTINGS_STATUS_BEARER_2_4G")}}function c(){var q=arrayOfdevices();var p={};p.helpImg1=q[q.length-1].helpImg1;p.helpImg2=q[q.length-1].helpImg2;$.each(q,function(r,s){if(s.name===productInfo.getProductDeviceName()){p.helpImg1=s.helpImg1;p.helpImg2=s.helpImg2;return false}});$('img[id="wifiHelpImg"]').attr("src",p.helpImg1);$('img[id="routerHelpImg"]').attr("src",p.helpImg2)}var m={};function e(q){var p="";if(m[q]===undefined){jQuery.ajax({url:"modules/"+q+".html",success:function(r){m[q]=r;p=r},async:false})}else{p=m[q]}return p}function b(q){var r=q?q:(urlParams&&urlParams.topic)?urlParams.topic:undefined;if(r){if(productInfo.isMobileWifi()){$("#browseBroadbandHelp").html(e("mobileWifiHelp"));var t=helpMobileWifi.getTopicFromLegacyMapping(r);helpMobileWifi.setTopicBreadcrumbs(t);helpMobileWifi.displayCorrectTopic(t)}else{$("#browseBroadbandHelp").html(e("quickstartHelp"));helpQuickstart.hideAllTopicsAndTips();helpQuickstart.quickStartBreadcrumb(r);helpQuickstart.quickstartTopicsMapping(r)}}else{$("#browseBroadbandHelp").html(e("broadbandHelp"));c()}if(!productInfo.isMobileWifi()){$("#broadbandHelp").find(".mobilewifi").remove()}n();var p=document.getElementById("supportOnlineHelpBtn");if(p){var s=Util.appendHttpToUrl(OpCo.supportUrl);p.setAttribute("href",s)}ConnectionManager.setPageConnectionStatusUpdateFunction(function(u){if(u.connectionTextTr){$("#connectionState").removeClass();$("#connectionState").setTranslation(u.connectionTextTr)}});k();d();initialiseAccordion();if(q){$("#browseBroadbandHelp *").translateElements();pageLoader.onContentTranslated()}g();guestUserLogic.processStorage();$("#browseBroadbandHelp").find("*[topic]").addClass("cursorPointer")}function j(){b();$(document).on("languageObject.created",function(){initialiseAccordion()});$("body").on("click",".accordionClosed > a, .accordionOpen > a",function(){var p=$(this).closest("h3").attr("id");var q=p.replace("Title","Content");h(q)}).on("click","a[topic]",function(){var p=$(this).attr("topic");b(p)});page.dataReceived()}$.extend(this,{views:["desktopView"],doSpecificStuff:j,name:"help",menuName:"HELP",children:["help","diagnostics","onlineUpdate","deviceControls","about","support","network-unlock"],renderLayout:layout.threeColumn,parent:"welcome"})}function support(){function b(){var c=XmlCache.getSupport();$("#mainIdea, #mainIdeaMob").html(c)}function a(){b();page.dataReceived()}$.extend(this,{name:"support",parent:"help",backButton:"help-mobile",renderLayout:layout.threeColumn,menuName:"SUPPORT",doSpecificStuff:a})}function onlineupdate(){var g="";function f(){SetUpdateStatus("download",function(h){if(!h){$(document).trigger("firmwareUpdate.failed",["download"]);return}UserNotification.showPrompt(function(){SetUpdateStatus("cancel",function(j){if(j){UserNotification.hidePrompt()}})},{titleTrClass:"UPDATING_PRODUCT_NAME",messageTrClass:"DOWNLOADING_AVAILABLE_UPDATE",messageTrClass4:"DOWNLOAD_PROGRESS",modHeader:"true",progressBar:"true",button2TrClass:"NETWORK_REFRESH_CANCEL",containerClass:"networkUnlockedPopup clearfix",footnoteTrClass:productInfo.isQuickStart()?"ENSURE_CONNECTED_Quickstart":"ENSURE_CONNECTED_MobileWifi"})})}function d(h){if(h==="check"){$("body").off("click","#onlineUpdateButton").on("click","#onlineUpdateButton",e)}else{$("body").off("click","#onlineUpdateButton").on("click","#onlineUpdateButton",f)}}function c(h,j){function k(o,n){if(o==="use"&&n<50){$("#onlineUpdateButton").prop("disabled",true).addClass("disabled");b()}else{$("#onlineUpdateButton").prop("disabled",false).removeClass("disabled");d("download");UserNotification.removeResponse()}}if(!h){$("#checkingUpdateStatus").setTranslation("NOT_POSSIBLE_CHECK_UPDATES").show();throbber.hide();return}if(!Util.isEmptyObject(j)){g=j.newVersion;productInfo.setProductUpdateVersion(g);$("#newFwVersionHeader, #newFwVersion, #updateBenefitsHeader, #benefitsOfUpdate, #updateGuidance").show();$("#updateButtonText").setTranslation("UPDATE_ON_DEVICE");var m=formatting.getTotalVolumeDisplayString(j.size);$("#newFwVersion").html(g+" <"+m+">");$("#benefitsOfUpdate").html(j.updateBenefits);d("download");if(device&&device.supportedFeatures&&device.supportedFeatures.BATTERY&&$.isFunction(WiFiShared.getBatteryStatus)){var l=WiFiShared.getBatteryStatus();if(l&&l.batteryLevel&&l.batteryStatus){k(l.batteryStatus,l.batteryLevel)}}$(document).on("batteryWarning",function(o,p,n){k(p,n)})}else{$("#checkingUpdateStatus").show()}throbber.hide()}function e(){throbber.show("CHECKING_FOR_UPDATES");CheckUpdateAvailable(c)}function b(){if($("#updateMessage").length===0){var h={error:true,hintTitleTr:"TR_LOW_BATTERY_TITLE",hintTextTr:"TR_LOW_BATTERY_MESSAGE"};UserNotification.showResponse(h)}}function a(){page.dataReceived();d("check");$("#currentFwVersion").html(GetSoftwareVersion());e()}$.extend(this,{name:"onlineUpdate",menuName:"TR_UPDATE_DEVICE",renderLayout:layout.threeColumn,requiresLoggedIn:true,isMobilewifi:true,parent:"help",isOnlineUpdate:true,doSpecificStuff:a,backButton:"help-mobile"},(typeof testing==="boolean"&&testing)?{downloadUpdate:f}:{})}function welcome(){function b(){if(productInfo.isMobileWifi()){$("#indexPageTitle").setTranslation("WELCOME_TO_VODAFONE_MOBILE_WIFI");$("#indexPageParagraph1").setTranslation("INDEX_PARA_1_MOBILE_WIFI");$("#indexPageParagraph2").setTranslation("INDEX_PARA_2_MOBILE_WIFI");$("#indexPageHelpTitle").setTranslation("INDEX_MOBILE_WIFI_HELP_TITLE")}else{$("#indexPageTitle").setTranslation("WELCOME_TO_VODAFONE_QUICKSTART");$("#indexPageParagraph1").setTranslation("INDEX_PARA_1");$("#indexPageParagraph2").setTranslation("INDEX_PARA_2");$("#indexPageHelpTitle").setTranslation("HELP")}}function a(){if(ConnectionManager.isLimitedService()){pageLoader.loadPage("limited-service")}$(document).on("limited-service",function(){if(page.name==="welcome"){pageLoader.loadPage("limited-service")}});if(OpCo.country==="Egypt"){$("#egyptManageAccountLink").removeClass("hideImportant")}b();if(IsMessagePreview()&&$.isFunction(SMS.showSMSPage)){SMS.storeType=2;SMS.showSMSPage(1);if(authentication.isLoggedIn()||productInfo.isQuickStart()){$("body").on("click",".linkable",function(){var c=$(this).parent(this).attr("data-pageparameters");pageLoader.loadPage("sms-write",c)})}}if(productInfo.isMobileWifi()&&device.routerSettings.routerIpAndDomainNameSetup){$("#indexPageParagraph2").show()}ConnectionManager.setPageConnectionStatusUpdateFunction(function(c){$("#connectAndDisconnectButton").removeClass().setTranslation(c.connectionButtonTextTr);var d=c.connectionStatus==="connected"?"INDEX_PARA_3_DISCONNECT_TEXT":"INDEX_PARA_3";$("#indexPageParagraph3").removeClass().setTranslation(d)});connectionInfo.updateConnectionInfo();$("body").on("click",".indexPageConnectBtn",ConnectionManager.toggleConnection);if(!IsMessagePreview()){$("#smsInboxIdArea").hide();page.dataReceived()}}$.extend(this,{footer:layout.smallFooter,doSpecificStuff:a,views:["desktopView"]})}var TOKEN_XYZ="23456yu";function account(){function d(){if(OpCo.prepay.check!==""){return"account-balance"}else{if(OpCo.prepay.topup!==""||OpCo.prepay.online!==""){return"top-up"}}return"account-details"}function b(){pageLoader.loadPage(d())}function c(){if(OpCo.account_type==="Prepaid"){b()}else{if(opCoInfo.isGhanaian()){b()}else{pageLoader.loadPage("account-details")}}}function a(){c()}$.extend(this,{doSpecificStuff:a,name:"account",parent:"account",requiresLoggedIn:true},(typeof testing==="boolean"&&testing)?{getAccountPage:d}:{})}function accountbalance(){var h=$.noop;function g(j){$("#updateMessage").remove();if(j){prepayBalance=formatting.formatPrepayBalance(j)}prepayBalance=prepayBalance.replace(/\\n/g,"<br/>");$("#accountBalanceParagraph1").translateElements();$("#accountBalanceParagraph2").html(prepayBalance);throbber.hide()}function e(k,j){if(page.name!=="account-balance"){return}clearTimeout(h);if(OpCo.check_balance_method==="USSD_SMS"){g(j.body);$(document).trigger("balanceUpdated.USSD_SMS")}else{if(j.from===OpCo.prepay.check){g(j.body)}}}function f(j,k){pageLoader.logger.debug("sendPrePayUSSDCallback("+j+","+k+")");clearTimeout(h);if(k==="USSD NOT SUPPORTED"){throbber.hide();UserNotification.showGenericVendorResponse(false,{hintTitleTr:"TR_PLEASE_TRY_LATER",hintTextTr:""});return}if(j&&k){if(OpCo.check_balance_method==="USSD_SMS"&&!opCoInfo.isEgypt()){return}throbber.hide();g(k)}else{throbber.hide();UserNotification.showGenericVendorResponse(j,{hintTitleTr:"TR_PLEASE_TRY_LATER",hintTextTr:""})}}function d(){UserNotification.showResponse({error:true,hintTitleTr:"TR_REQUEST_TIMED_OUT",hintTextTr:"TR_PLEASE_TRY_LATER",callback:function(j){j.appendTo($("#accountBalanceTimeoutError"))}});throbber.hide()}function b(){function j(){if(typeof OpCo!=="undefined"&&(OpCo.check_balance_method==="USSD"||OpCo.check_balance_method==="USSD_SMS")){throbber.show();h=setTimeout(d,120000);pageLoader.logger.debug("function timedOut - SendUSSDAndGetResponse("+OpCo.prepay.check+",sendPrePayUSSDCallback)");SendUSSDAndGetResponse(OpCo.prepay.check,f)}else{if(typeof OpCo!=="undefined"&&OpCo.check_balance_method==="SMS"){throbber.show();var k=[OpCo.prepay.check];var l=function(m){if(!m){$("#updateMessage").remove();UserNotification.showGenericVendorResponse(false,{hintTextTr:"TR_PLEASE_TRY_LATER"});throbber.hide();clearTimeout(h)}};SMS.sendSMS("-1",k,OpCo.check_balance_SMS_MSG,l);h=setTimeout(d,120000)}}}page.dataReceived();throbber.show();$("#updateMessage").remove();j()}function c(){if(typeof OpCo!=="undefined"&&(OpCo.check_balance_method==="SMS"||OpCo.check_balance_method==="USSD_SMS")&&!opCoInfo.isEgypt()){if(prepayBalance!==""){$("#accountBalanceParagraph2").html(prepayBalance)}page.dataReceived();return}b()}function a(){$("body").on("click","#accountBalanceRefreshBtn",b);$(document).on("numbersToMonitor.newDataArrived",e);c()}$.extend(this,{doSpecificStuff:a,name:"account-balance",menuName:"BALANCE_TITLE",parent:"account",backButton:"account-mobile",doBalanceCheck:b,requiresLoggedIn:true})}function accountdetails(){var c=" &#967;&#961;&#942;:";var b="My account:";function d(){$("#accountDetailsSubheading").hide();if(OpCo.account_type==="Prepaid"){$("#accountDetailsParagraph1").setTranslation("AD_ACCOUNT_DETAILS_1_MCCMNC_20205_PREPAY");$("#accountDetailsParagraph2").hide();$("#accountDetailsRegisterBtn").hide()}else{$("#accountDetailsParagraph2").hide();$("#accountDetailsParagraph1").removeClass().addClass("AD_ACCOUNT_DETAILS_1_MCCMNC_20205_POSTPAY1");$("#accountDetailsParagraph1").before("<h4>"+c+"</h4>");$("#accountDetailsParagraph1").after("<h4>"+b+'</h4> <p class="AD_ACCOUNT_DETAILS_1_MCCMNC_20205_POSTPAY2" id="accountDetailsParagraph11"/>')}}function a(){if(OpCo.country==="Italy"||OpCo.country==="Egypt"){$("#accountDetailsRegisterBtn").hide()}if(OpCo.country==="Egypt"){$("#accountDetailsTitle").setTranslation("ACCOUNT_MANAGEMENT");$("#egyptAccountDetails").removeClass("hideImportant")}if(OpCo.country==="Greece"){d()}$("#accountDetailsRegisterBtn").attr("href",OpCo.my_account_registration);page.dataReceived()}$.extend(this,{doSpecificStuff:a,name:"account-details",menuName:"AD_ACCOUNT_DETAILS",parent:"account",backButton:"account-mobile",requiresLoggedIn:true})}function accountmanage(){var h=$.noop;function g(j){$("#updateMessage").remove();if(j){prepayBalance=formatting.formatPrepayBalance(j)}prepayBalance=prepayBalance.replace(/\\n/g,"<br/>");$("#accountBalanceParagraph1").translateElements();$("#accountBalanceParagraph2").html(prepayBalance);throbber.hide()}function e(k,j){if(page.name!=="account-balance"){return}clearTimeout(h);if(OpCo.check_balance_method==="USSD_SMS"){g(j.body);$(document).trigger("balanceUpdated.USSD_SMS")}else{if(j.from===OpCo.prepay.check){g(j.body)}}}function f(j,k){pageLoader.logger.debug("sendPrePayUSSDCallback("+j+","+k+")");clearTimeout(h);if(k==="USSD NOT SUPPORTED"){throbber.hide();UserNotification.showGenericVendorResponse(false,{hintTitleTr:"TR_PLEASE_TRY_LATER",hintTextTr:""});return}if(j&&k){if(OpCo.check_balance_method==="USSD_SMS"){return}throbber.hide();g(k)}else{throbber.hide();UserNotification.showGenericVendorResponse(j,{hintTitleTr:"TR_PLEASE_TRY_LATER",hintTextTr:""})}}function d(){UserNotification.showResponse({error:true,hintTitleTr:"TR_REQUEST_TIMED_OUT",hintTextTr:"TR_PLEASE_TRY_LATER",callback:function(j){j.appendTo($("#accountBalanceTimeoutError"))}});throbber.hide()}function b(){page.dataReceived();throbber.show();$("#updateMessage").remove();if(typeof OpCo!=="undefined"&&(OpCo.check_balance_method==="USSD"||OpCo.check_balance_method==="USSD_SMS")){throbber.show();h=setTimeout(d,120000);pageLoader.logger.debug("function timedOut - SendUSSDAndGetResponse("+OpCo.prepay.check+",sendPrePayUSSDCallback)");SendUSSDAndGetResponse(OpCo.prepay.check,f)}else{if(typeof OpCo!=="undefined"&&OpCo.check_balance_method==="SMS"){throbber.show();var j=[OpCo.prepay.check];var k=function(l){if(!l){$("#updateMessage").remove();UserNotification.showGenericVendorResponse(false,{hintTextTr:"TR_PLEASE_TRY_LATER"});throbber.hide();clearTimeout(h)}};SMS.sendSMS("-1",j,OpCo.check_balance_SMS_MSG,k);h=setTimeout(d,120000)}}}function c(){if(typeof OpCo!=="undefined"&&(OpCo.check_balance_method==="SMS"||OpCo.check_balance_method==="USSD_SMS")){if(prepayBalance!==""){$("#accountBalanceParagraph2").html(prepayBalance)}page.dataReceived();return}b()}function a(){$("body").on("click","#accountManageRefreshBtn",b);$(document).on("numbersToMonitor.newDataArrived",e);c()}$.extend(this,{doSpecificStuff:a,name:"account-manage",menuName:"MANAGE_MY_ACCOUNT",parent:"account",backButton:"account-mobile",doBalanceCheck:b,requiresLoggedIn:true})}function accounttype(){function b(){var c=document.getElementById("accountType");var d=c[c.selectedIndex].value;SetAccountType(d,function(e){accountFunctions.setAccountTypeCallback(e,true)})}function a(){$("body").on("click","#accountTypeSaveBtn",b);if(!simInfo.activationRequired()){$(document).trigger("buildAccountTypeDropDown")}page.dataReceived()}$.extend(this,{doSpecificStuff:a,name:"account-type",parent:"account",backButton:"account-mobile",menuName:"AD_ACCOUNT_TYPE",requiresLoggedIn:true})}function connecting(){function b(c){if(ConnectionManager.isConnected()||c.connectionStatus==="disconnected"){if($(".genericPopupOverlay").is(":visible")){$(".genericPopupOverlay").hide()}pageLoader.loadPage("welcome")}}function a(){if(productInfo.isMobileWifi()){$("#connectingHelpParagraph2").setTranslation("CONNECTING_HELP_TEXT2")}else{$("#connectingHelpParagraph2").setTranslation("CONNECTING_HELP_TEXT21")}ConnectionManager.setConnectFunction($.noop);ConnectionManager.setPageConnectionStatusUpdateFunction(b);page.dataReceived()}$.extend(this,{doSpecificStuff:a,name:"connecting"})}function connection(){var e=$.noop;function n(r){$("#bbAPN").val(r.strAPN);$("#bbConnectNumber").val(r.strNumber);$("#bbDNS").val(r.strDNS);$("#bbDNS2").val(r.strDNS2);$("#bbSecurity").val(r.strSecurity);$("#bbUsername").val(r.strUsername);$("#password1").val(r.strPassword)}function h(r){var s=(r==="0")?"TR_CONNECTION_FULL_PARA_11":"TR_CONNECTION_FULL_PARA_1";$("#connectionSettingsParagraph1").setTranslation(s)}window.setAutoConnectionText=h;function m(s){var t=$("#accountType").val();if(s){$("#connectionSettingsParagraph1").show();$("#connectionSettingsParagraph2").show();$("#connectionSettingsParagraph3").show();$("#connectionSettingsParagraph1").removeClass("TR_CONNECTION_PARA_1");$("#connectionSettingsParagraph2").removeClass("TR_CONNECTION_FULL_PARA_1");$("#connectionSettingsParagraph3").addClass("TR_CONNECTION_FULL_PARA_2");var r=$("#connectionMode").val();h(r);if(t==="Custom"){$("#connectionIdleSettings").show()}$("div[id^='CSMW_']").show();$("#idle").val(VendorWifi.GetIdleTime().value);guestUserControls.Set(null)}else{$("#connectionSettingsParagraph1").show();$("#connectionSettingsParagraph2").hide();$("#connectionSettingsParagraph3").show();$("#connectionSettingsParagraph2").removeClass("TR_CONNECTION_FULL_PARA_1");if(t==="Custom"){$("#connectionIdleSettings").show()}$("div[id^='CSMW_']").hide()}}function d(t,s,r){if(r){if(view.getMode()==="mobileView"){$("#connectionMode").val(t).selectmenu({preventFocusZoom:true}).selectmenu("refresh")}else{$("#connectionMode").val(t)}$("#connectionModeContainer").show();h(t);$("#autoConnectCheckbox").prop("checked",s);j();if(view.getMode()==="mobileView"){$("#autoConnect_flipToggle")[0].selectedIndex=s;$("#autoConnect_flipToggle").slider("refresh")}window.getConnectionModeCallback=$.noop}}function j(){$("#autoConnectCheckbox").prop({disabled:($("#connectionMode").val()==="1")});$("#autoConnectWhenRoaming").toggleClass("mobileViewHidden",$("#connectionMode").val()==="1");connectionInfo.connectionMode=$("#connectionMode").val();connectionInfo.autoConnectWhenRoaming=$("#autoConnectCheckbox").is(":checked")}function k(){var r=$("#accountType").val();if(r==="Custom"){$("#customFields").show();if(productInfo.isMobileWifi()){$("#connectionIdleSettings").show()}}else{$("#customFields").hide()}a()}function b(){var r=false;$("#accountType option").each(function(){if(this.value==="Custom"){r=true}});if(!r){Util.addOption("connectionSettingsAccountTypeCustom",document.getElementById("accountType"),languageManager.CUSTOM,"Custom","CUSTOM");setTimeout(function(){$("#accountType").removeClass("specialAccountTypeHideForIOS4")})}k()}function q(r){if(!r){UserNotification.showGenericVendorResponse(r)}}function p(r){$("#connectionSettingsAPNLabel").setTranslation(r+"APN");$("#connectionSettingsConnectNumLabel").setTranslation(r+"NUMBER");$("#connectionSettingsDNSLabel").setTranslation(r+"DNS");$("#connectionSettingsDNS2Label").setTranslation(r+"DNS2");$("#connectionSettingsUsernameLabel").setTranslation(r+"USERNAME");$("#connectionSettingsPasswordLabel").setTranslation(r+"PASSWORD");$("#connectionSettingsPasswordLabel2").setTranslation(r+"CONFIRM_PASSWORD")}function a(){if(device.supportedFeatures.hasOwnProperty("IPVersionSupport")&&$("#accountType").val()==="Custom"){if($("#ipType").val()==="IPv4"){p("IPV4");$("#bbDNS, #bbDNS2").data("validator","OptionalDNS")}else{if($("#ipType").val()==="IPv6"){p("IPV6");$("#bbDNS, #bbDNS2").data("validator","IpV4Or6")}else{p("IPV4IPV6");$("#bbDNS, #bbDNS2").data("validator","IpV4Or6")}}}}function f(){a()}function c(t){if(!UserNotification.formValidated()){$("#loadPage").find("a").unbind("click").click(function(u){$("#updateMessage").remove()});return}function s(){function B(){if(productInfo.isMobileWifi()){guestUserControls.Set({allowedToConnect:$("#allowGuestUsersCheckbox").is(":checked"),allowedToAccessSettings:$("#allowGuestMobileSettingsCheckbox").is(":checked")});VendorWifi.SetIdleTime({value:$("#idle").val()})}}function v(){var C=$("#accountType").val();SetAccountType(C,function(D){accountFunctions.setAccountTypeCallback(D,false);if(D){A()}else{throbber.hide()}})}function y(C){var D=$("#connectionMode").val();if(!C){Util.log("setConnectionModeCallback failed")}else{h(D)}UserNotification.showGenericVendorResponse(C)}function A(){var C=$("#idle").val();var F=$("#autoConnectCheckbox").is(":checked");var D=$("#connectionMode").val();var E=CallbackWrapper.wrapCallback(function(H){y(H);if(H){j();var G=setTimeout(function(){throbber.hide()},10000);ConnectionManager.connectToInternet(function(){clearTimeout(G);throbber.hide()});d(D,F,H);B()}else{throbber.hide();window.getConnectionModeCallback=d}});SetConnectionMode(D,F,E)}function u(){v()}function x(){function D(P,N,Q,K,L,M,O){SetCustomAccountType(P,N,Q,K,L,M,O,function(R){q(R);if(R){u();opCoInfo.refreshAccountList()}else{throbber.hide()}})}var I=$("#bbAPN").val();var G=$("#bbConnectNumber").val();var J=$("#bbDNS").val();var C=$("#bbDNS2").val();var E=$("#bbSecurity").val();var F=$("#bbUsername").val();var H=$("#password1").val();D(I,G,J,C,E,F,H)}function w(){if(typeof SetIPType!=="undefined"&&$.isFunction(SetIPType)){SetIPType($("#ipType").val(),function(C){if(C){GetIPType(function(D,E){if(D){$("#ipType").val(E)}})}})}}w();var z=$("#accountType").val();if(z==="Custom"){x()}else{u()}}if(ConnectionManager.isConnected()){var r={button1TrClass:"ERROR_OK",button2TrClass:"TR_ERROR_CANCEL",titleTrClass:"TR_REQUIRES_DISCONNECT_TITLE",messageTrClass:"TR_REQUIRES_DISCONNECT_TEXT"};UserNotification.showPrompt(function(u){if(u){throbber.show();ConnectionManager.toggleConnection(function(v){if(v){setTimeout(function(){s()},1000)}else{UserNotification.showGenericVendorResponse(false)}})}},r)}else{throbber.show();s()}}window.handleSave=c;function l(){$("#loadPage").find("select").change(function(){$("#updateMessage").remove()});$("#loadPage").find("input").click(function(){$("#updateMessage").remove()});$("#loadPage").find("a").click(function(){$("#updateMessage").remove()})}function o(){if(typeof GetSupportedConnectionModes==="function"){GetSupportedConnectionModes(function(s,t){if(s){if(t.bOnDemand){$("#connectionMode").append('<option class="ON_DEMAND" id="connectionSettingsConnectModeSelect3" value="2"></option>')}$("#connectionMode *").translateElements()}window.getConnectionModeCallback=d})}else{window.getConnectionModeCallback=d}if(typeof GetSupportedAuthenticationTypes==="function"){GetSupportedAuthenticationTypes(function(s,u){if(s){$("#bbSecurity").empty();var t=[];$.each(u,function(w,v){t.push({name:v,value:w+1,clazz:v})});$.tmpl(HTMLTemplates.htmlOption,t).appendTo("#bbSecurity")}})}l();function r(s,t){if(s){$("#ipType option").remove();$("select#ipType.ipType").removeAttr("disabled",true);$("#ipDropdownHelpText").show();$.each(t,function(u,v){Util.addOption(v,document.getElementById("ipType"),v,v)});$("#connectionSettingsAPNLabel").setTranslation("IPV4APN");$("#connectionSettingsConnectNumLabel").setTranslation("IPV4NUMBER");$("#connectionSettingsDNSLabel").setTranslation("IPV4DNS");$("#connectionSettingsDNS2Label").setTranslation("IPV4DNS2");$("#connectionSettingsUsernameLabel").setTranslation("IPV4USERNAME");$("#connectionSettingsPasswordLabel").setTranslation("IPV4PASSWORD");$("#connectionSettingsPasswordLabel2").setTranslation("IPV4CONFIRM_PASSWORD");GetIPType(function(u,v){if(u){$("#ipType").val(v)}f()});if(t.length===1&&(($.inArray("IPv4",t)>-1)||($.inArray("IPv6",t)>-1)||($.inArray("IPv4 + IPv6",t)>-1))){$("select#ipType.ipType").attr("disabled",true);$("#ipDropdownHelpText").hide()}$(document).on("change","#ipType",f)}}if(typeof GetSupportedIPTypes==="function"&&device.supportedFeatures.hasOwnProperty("IPVersionSupport")){GetSupportedIPTypes(r)}$("body").on("change","#accountType",k).on("change","#connectionMode",j).on("accountTypeDropdownBuilt",b)}function g(){o();$("body").on("setGuestUserConnectionText",function(s,t){if(t.getAllowedToConnect()){$("#allowGuestUsersCheckbox").attr("checked","checked");$("#connectionSettingsParagraph2").setTranslation("TR_CONNECTION_GUEST_USER_ON")}else{$("#allowGuestUsersCheckbox").removeAttr("checked");$("#connectionSettingsParagraph2").setTranslation("TR_CONNECTION_GUEST_USER_OFF")}if(t.getAllowedToAccessSettings()){$("#allowGuestMobileSettingsCheckbox").attr("checked","checked")}else{$("#allowGuestMobileSettingsCheckbox").removeAttr("checked")}});var r=GetCustomAccountType();if(r!==null){n(r)}UserNotification.validation.validateChangePassword=function(s){if($("#password2").val()!==""){$("#password2").blur()}return UserNotification.validation.validateConnectionUserName(s)};UserNotification.validation.validateConfirmPassword=function(t){var s=$("#password1").val()===$("#password2").val();return s};m(productInfo.isMobileWifi());ConnectionManager.setPageConnectionStatusUpdateFunction(function(s){$("#quickStartStatusConnection").attr("class",s.connectionClass).setTranslation(s.connectionTextTr);$("*[data-button=connection]").setTranslation(s.connectionButtonTextTr)});connectionInfo.updateConnectionInfo();$("body").on("change","#customFields input",function(){if(e===$.noop){e=function(){ConnectionManager.toggleConnection(function(){ConnectionManager.toggleConnection()})}}});$("body").one("accountTypeDropDownBuilt",b);if(simInfo.activationRequired()){$("#customFields").hide()}else{$(document).trigger("buildAccountTypeDropDown")}page.dataReceived()}$.extend(this,{doSpecificStuff:g,id:"leftNavQuickStartConnection",name:"connection",menuName:"NETWORK_SETTINGS_CONNECTION",parent:"network-status",requiresLoggedIn:true,renderLayout:layout.threeColumn,backButton:"settings-mobile"})}function debug(){function b(){try{SetBannerIcon(OpCo.partnerLogo);SetSupportURL(OpCo.supportUrl);SetHomePageURL(OpCo.homepageUrl);translator.createLanguageObject()}catch(c){Util.log("index opCoIsePage caught "+c)}}function a(){try{InjectOpCoFileForIMSI()}catch(c){Util.log("index $(document).ready() caught "+c)}page.dataReceived()}$.extend(this,{footer:layout.smallFooter,doSpecificStuff:a,parent:"welcome",name:"debug"})}function genericerror(c){function d(f,g){if(typeof languageManager["GENERIC_ERROR_"+g]==="string"){$(f).setTranslation("GENERIC_ERROR_"+g)}}var e=(function e(){function g(){var j=urlParams.errorType;if(typeof languageManager["TR_ERROR_TITLE_"+j]!=="string"){j="GENERIC"}return j}function f(){if(typeof languageManager!=="undefined"){return"TR_ERROR_TITLE_"+g()}}function h(){var k=urlParams.errorType;var l;var j;if(typeof languageManager["TR_ERROR_TITLE_"+k]!=="string"){l=languageManager.TR_ERROR_TEXT_GENERIC+"<strong> "+urlParams.errorType+" ("+urlParams.errorId+")</strong>"}else{j="TR_ERROR_TEXT_"+k}return{text:l,textClass:j}}return{getErrorType:g,getGenericErrorTitle:f,getErrorText:h}}());function b(){var f=e.getErrorType();$("#genericErrorTitle").setTranslation(e.getGenericErrorTitle());$("#genericErrorTitleMobile").setTranslation(e.getGenericErrorTitle());if(!e.getErrorText().text){$("#genericErrorParagraph1").setTranslation(e.getErrorText().textClass)}else{$("#genericErrorParagraph1").html(e.getErrorText().text)}if(f){jQuery("#genericErrorContextHelp").show();if(typeof languageManager["GENERIC_ERROR_"+f+"_TITLE"]==="string"){jQuery("#genericErrorHelpTitle").setTranslation("GENERIC_ERROR_"+f+"_TITLE");d("#genericErrorHelpCol1",f+"_COL1");d("#genericErrorHelpCol2",f+"_COL2");d("#genericErrorHelpCol3",f+"_COL3")}else{jQuery("#genericErrorHelpTitle").setTranslation("GENERIC_TITLE");d("#genericErrorHelpCol1","GENERIC_COL1")}}}function a(){$(document).on("page.complete",b);jQuery("#genericErrorHelp *").translateElements();page.dataReceived()}$.extend(this,c,{footer:layout.smallFooter,doSpecificStuff:a,name:"generic-error",parent:"welcome"},(typeof testing==="boolean"&&testing)?{errorInfo:e}:{})}function limitedservice(c){function e(){$("#limitedServiceCol1Paragraph1").setTranslation("TR_LIMITED_SERVICE_HELP_PARA_1");$("#limitedServiceCol1Paragraph2").show();$("#limitedServiceCol2Paragraph1").setTranslation("TR_LIMITED_SERVICE_HELP_PARA_3");$("#limitedServiceCol2Paragraph2").setTranslation("TR_LIMITED_SERVICE_HELP_PARA_4");$("#limitedServiceCol3Paragraph1").setTranslation("TR_LIMITED_SERVICE_HELP_PARA_5");$("#limitedServiceCol3Paragraph11").show();$("#limitedServiceCol3Paragraph2").show();$("#limitedServicePara4,#limitedServicePara5").hide()}function d(){$("#limitedServiceCol1Paragraph1").setTranslation("TR_LIMITED_SERVICE_HELP_PARA_7");$("#limitedServiceCol1Paragraph2").hide();$("#limitedServiceCol2Paragraph1").setTranslation("TR_LIMITED_SERVICE_HELP_PARA_8");$("#limitedServiceCol2Paragraph2").setTranslation("TR_LIMITED_SERVICE_HELP_PARA_9");$("#limitedServiceCol3Paragraph1").setTranslation("TR_LIMITED_SERVICE_HELP_PARA_10");$("#limitedServiceCol3Paragraph11").hide();$("#limitedServiceCol3Paragraph12").hide();$("#limitedServiceCol3Paragraph2").hide()}function b(f){if(f.automatic&&!f.manualBearer){e()}else{d();if((f.automatic&&f.manualBearer)){$("#limitedServicePara5").show();$("#limitedServicePara4").hide()}else{if(!f.automatic&&!f.manualBearer){$("#limitedServicePara4").show();$("#limitedServicePara5").hide()}else{if(!f.automatic&&f.manualBearer){$("#limitedServicePara4").show();$("#limitedServicePara5").show()}}}}$("#limitedServiceHelp *").translateElements()}function a(){var f=TagSubstitution.NETWORK_ACQUISITION()===languageManager.AUTOMATIC;GetBearerPreference(function(h,g){if(g){var k=(h.indexOf("3G Preferred")===-1)&&(h.indexOf("4G Preferred")===-1);b({automatic:f,manualBearer:k})}else{var j=f?e:d;j();$("#limitedServicePara4").show();$("#limitedServicePara5").hide()}$("#webMobileLangSwitch").removeClass("hidden");page.dataReceived()})}$.extend(this,c,{doSpecificStuff:a,name:"limited-service",menuName:"LIMITED_SERVICE",parent:"welcome"})}function networksettings(){function o(){$(".error").hide();$(".confirmation").hide()}function b(){GetBearerPreference(function(F,E){getBearerPreferenceCallback(F,E)})}function k(){c=0;w();s(false);throbber.hide()}function s(E){$("#networkSettingsSaveBtn, #networkSettingsSaveBtn2").toggle(E)}function w(){if(!guestUserLogic.isAllowedToConnectDisconnect()&&!productInfo.isQuickStart()){$("#networkSettingsRefreshBtn").hide();return}$(".radioButtons").off("change").on("change",function(E){if(!ConnectionManager.isConnecting()){s(true)}})}var c=0;function n(){setTimeout(function(){c++;if(ConnectionManager.isConnected()){k()}else{if(c<=40){n()}else{k()}}},1000)}function d(E){if(E){$(".radioButtons").off("mousedown");connectionInfo.updateConnectionInfo();if(connectionInfo.connectionMode==="1"||(connectionInfo.isRoaming&&!connectionInfo.autoConnectWhenRoaming)||ConnectionManager.isLimitedService()){k()}else{setTimeout(function(){ConnectionManager.connectToInternet(n)},5000)}UserNotification.showGenericVendorResponse(E);b()}else{UserNotification.showGenericVendorResponse(E,{hintTextTr:"TR_PLEASE_TRY_LATER"});throbber.hide()}}function g(){throbber.show();o();var E=0;var F="";var G=document.getElementsByName("connectionType");for(E=0;E<G.length;E++){if(G[E].checked){switch(G[E].id){case"networkSettings4gPref":F="4G Preferred";break;case"networkSettings4g":F="4G Only";break;case"networkSettings3gPref":F="3G Preferred";break;case"networkSettings3g":F="3G Only";break;case"networkSettingsGPRS":F="2G Only";break}SetBearerPreference(F,d);break}}}function C(){$("#returnedNetworks").html("")}function j(E){if(!E){a(E);return}C();$("#networkSettingsAutoLabel").setTranslation("AUTOMATIC");z();b();UserNotification.showGenericVendorResponse(E);d(true);var F=[{displayClass:"AUTOMATIC",isSelected:true,index:"radio"}];$(document).trigger("mobileSplitButtonList.view",[F])}function B(E,F){if(F&&F.strFullName.length>0){$("#updateMessage").remove();$("body").off("new.networkInfo")}else{h()}}function v(){if(simInfo.simState()!=="ready"){return}if(ConnectionManager.isLimitedService()){setNetworkConnectionStatus("limitedService");return}$("#mobileNetworkText").setTranslation("")}function a(E){$(document).trigger("networkInfo.processModel");UserNotification.showGenericVendorResponse(E,{hintTitleTr:"TR_PLEASE_TRY_AGAIN",hintTextTr:""});k();$("body").on("new.networkInfo",B);v()}function t(E){if(E){z();UserNotification.showGenericVendorResponse(E);d(true)}else{a(E)}$("body").one("new.networkInfo",m);$(document).trigger("networkInfo.registering")}function A(){throbber.show();o();var J=$("input[name=networkType]:radio:checked"),K=parseInt(J.attr("id"),10),I=J.data("network"),H=languageManager.TR_SEARCHING_FOR+" "+(I?I:languageManager.AUTOMATIC);connectionInfo.updateConnectionInfo();$(document).trigger("networkInfo.registering",H);if(isNaN(K)){SetNetworkAcquisitionToAutomatic(j)}else{var G=parseInt(J.attr("rat"),10),F=["2G","4G","3G"],E=F[G]||"";SetNetwork(J.val(),G,t);WiFiShared.setWebUiDataValue("customNetworkName",J.attr("data-network")+" "+E)}}function l(F){var E={button1TrClass:"ERROR_OK",button2TrClass:"TR_ERROR_CANCEL",titleTrClass:"TR_REQUIRES_DISCONNECT_TITLE",messageTrClass:"TR_REQUIRES_DISCONNECT_TEXT"};if(ConnectionManager.isConnected()){UserNotification.showPrompt(function(G){if(G){throbber.show();ConnectionManager.toggleConnection(function(H){if(H){if(F==="bearer"){$(document).one("new.networkInfo",m).trigger("networkInfo.getCachedObject");setTimeout(g,1000)}else{if(F==="network"){setTimeout(A,1000)}}}})}},E)}else{if(F==="bearer"){$(document).one("new.networkInfo",m).trigger("networkInfo.getCachedObject");g()}else{if(F==="network"){A()}}}s(false)}function D(F,L){$("#throbberSearching").hide();if(!F){return}var K=GetNetworkAcquisitionMode();var H="Current";var J="Allowed";var E="Not Allowed";var G="Unknown";if(languageManager){H=languageManager.CURRENT;J=languageManager.ALLOWED;E=languageManager.NOT_ALLOWED;G=languageManager.UNKNOWN}$.each(L,function(M,O){var N=formatting.getBearerStringFromnRat(O.nRat);O=$.extend(O,{displayName:O.strFullName+" "+N+" &ndash; "+(O.nState===2?H:(O.nState===1?J:(O.nState===0?G:E))),isChecked:(O.nState===2&&K===1?'checked="checked"':""),cssClass:(O.nState===1||O.nState===2?"greenTick":"redCross"),index:M,img:(O.nState===1||O.nState===2?"img/icons/connected_traffic.gif":"img/icons/not_connected_traffic.gif"),isSelected:O.nState===2&&K===1})});var I=$.tmpl(HTMLTemplates.networkListItem,L);$("#returnedNetworks").html(I);s(true);w();L.splice(0,0,{displayClass:"AUTOMATIC",img:"img/icons/blank.gif",isSelected:K===0,index:"radio"});$(document).trigger("mobileSplitButtonList.view",[L])}function e(){if((typeof device.supportedFeatures==="object")&&(typeof device.supportedFeatures.LTE==="boolean")&&device.supportedFeatures.LTE){$("#networkSettings3gPref").parent().hide();$("#mobnetworkSettings3gPref").remove();$("#networkSettingsHelpCol1Paragraph2").translateElements();$("#networkSettingsHelpCol2Paragraph2").setTranslation("NETWORK_HELP_COL2_4G");$("#networkSettingsHelpCol3Paragraph1").setTranslation("NETWORK_SETTINGS_HELP_COL31_4G")}else{$("#networkSettings4gPref").parent().hide();$("#mobnetworkSettings4gPref").remove();$("#networkSettings4g").parent().hide();$("#mobnetworkSettings4g").remove()}}function r(){function F(){$("#throbberSearching").show()}function G(){ScanForNetwork(D)}var E={button1TrClass:"ERROR_OK",button2TrClass:"TR_ERROR_CANCEL",messageTrClass:"TR_MANUAL_NETWORK_SEARCH",footnoteTrClass:"TR_MANUAL_NETWORK_SEARCH_FOOTNOTE"};if(ConnectionManager.isConnected()){s(false);UserNotification.showPrompt(function(H){if(H){F();ConnectionManager.toggleConnection(function(){setTimeout(function(){G();o()},1000)})}},E)}else{F();G();o()}}function x(){var E=TagSubstitution.substituteText(languageManager.NETWORK_ACQUISITION);if(E.indexOf(languageManager.AUTOMATIC)===-1&&$(".NETWORK_ACQUISITION").text().indexOf(languageManager.CURRENT)===-1&&$(".NETWORK_ACQUISITION").text().indexOf(languageManager.NOT_ALLOWED)===-1&&$(".NETWORK_ACQUISITION").text().indexOf(languageManager.ALLOWED)===-1){$(".NETWORK_ACQUISITION").text(E)}}function z(){$("#networkSettingsCurrentNetworkTitle").setTranslation("NETWORK_SETTINGS_CURRENT_NETWORK_TITLE");if(TagSubstitution.NETWORK_NAME()===""&&ConnectionManager.isLimitedService()){$("#networkSettingsCurrentNetworkTitle").removeClass();$("#networkSettingsCurrentNetworkTitle",languageManager.NETWORK_SETTINGS_CURRENT_NETWORK_TITLE+languageManager.TR_CachedNetwork_NOT_FOUND)}}function f(){$("#networkSettingsParagraph1").removeClass("NETWORK_SETTINGS_PARA1 NETWORK_SETTINGS_PARA1_1 TR_NETWORK_UNSUCCESSFUL");if(ConnectionManager.isLimitedService()){$("#networkSettingsParagraph1").addClass("TR_NETWORK_UNSUCCESSFUL");if(GetNetworkAcquisitionMode()===1){$("#networkNotFoundMessage").show()}else{$("#networkNotFoundMessage").hide()}}else{var E=ConnectionManager.isConnected()?"NETWORK_SETTINGS_PARA1":"NETWORK_SETTINGS_PARA1_1";$("#networkSettingsParagraph1").addClass(E);$("#networkNotFoundMessage").hide()}$("#networkSettingsParagraph1").translateElements()}function h(){if(languageManager){f();z();x()}}function m(G,H){$("#returnedNetworks").hide();var J=GetNetworkAcquisitionMode();var F=J===0;var K=[{displayClass:"AUTOMATIC",isSelected:F,index:"radio"}];if(!F){var E=$.extend(H,{displayClass:"NETWORK_ACQUISITION",isChecked:true,index:0});var I=$.tmpl(HTMLTemplates.networkListItem,E);$("#returnedNetworks").html(I);$("#returnedNetworks *").translateElements();K.push({displayClass:"NETWORK_ACQUISITION",isSelected:true,index:0})}else{$("#returnedNetworks").html("")}$("#currentNetworkPreference input:radio").prop("checked",F);$("#returnedNetworks").show();$(document).trigger("mobileSplitButtonList.view",[K])}function u(){var E=$(this).val();$("#"+E).prop("checked",true).trigger("mousedown");$(".radioButtons").trigger("change")}function y(){if(simInfo.simCardStatus().nSimState.toString()!=="1"){$("#networkSettingsRefreshBtn, #networkSettingsSaveBtn, #networkSettingsSaveBtn2").prop("disabled",true).addClass("disabled")}else{$("#networkSettingsRefreshBtn, #networkSettingsSaveBtn, #networkSettingsSaveBtn2").prop("disabled",false).removeClass("disabled")}}function q(){if(simInfo.redirectIfSimNotReady()){return}y();$("#networkSettingsAutoLabel").setTranslation("AUTOMATIC");z();$(document).on("networkSettings.setNetworkText",h).on("simCardStatusChange",y).one("new.networkInfo",m).trigger("networkInfo.getCachedObject");if(!(typeof testing==="boolean"&&testing)){Util.addHookAfter(window,"getBearerPreferenceCallback",function(){Util.removeHook(window,"getBearerPreferenceCallback");w()})}e();b();if(connectionInfo.isRoaming){$("#networkSettingsMessage").show()}else{$("#networkSettingsMessage").hide()}ConnectionManager.setPageConnectionStatusUpdateFunction(function(E){$("#connectANDdisconnectButton").attr("class",E.connectionButtonTextTr);$("#connectionState").attr("class",E.connectionTextTr)});$("body").on("click","#networkSettingsRefreshBtn",r).on("click","#networkSettingsSaveBtn2",function(){l("network")}).on("click","#networkSettingsSaveBtn",function(){l("bearer")}).on("click",".networkListItem",o).on("change","#connectionTypeDropdown",u).on("networkInfo.page",h);$("#networkSettingsCancelBtn").hide();s(false);$("body").trigger("new.networkInfo")}function p(F){if($(F.target).hasClass("preventClick")){return}$(".networkRadioButton").attr("src","img/icons/miniRedCross.gif");$(F.target).attr("src","img/icons/miniGreenTick.gif");var E=$(F.target).attr("idx");$("#"+E).attr("checked",true);l("network")}$.extend(this,{doSpecificStuff:q,setNetworkSettingsText:h,id:"leftNavQuickStartNetwork",name:"network-settings",menuName:"NETWORK",requiresLoggedIn:true,isValidForGuestUser:guestUserControls.getAllowedToAccessSettings,parent:"network-status",renderLayout:layout.threeColumn,backButton:"settings-mobile",handleTableRadioButtonClick:p},(typeof testing==="boolean"&&testing)?{setNetworkInPanel:v}:{})}function pinrequired(){function c(){$("#incorrectField").addClass("error").show()}function d(){window.location.replace("launch.html")}function b(g){simInfo.initialiseSimCardStatus();if(!simInfo.simCardStatus()){setTimeout(function(){b(g)},1000);return}if(g){if(productInfo.isMobileWifi()){if(simInfo.isNewPinStoreAPI()){VendorWifi.SetStoredPin({pin:$("#simPinStorePin").is(":checked")?$("#pin").val():""},d)}else{WiFiShared.setWebUiDataValue("pinValue",$("#simPinStorePin").is(":checked")?$("#pin").val():"",d)}}else{d()}}else{if(simInfo.pukRequired()){window.location.replace("home.htm?startPage=puk-required")}else{page.dataReceived();throbber.hide();c();$("#pin").val("");$("#simPinChangeUnSuccessful2").setTranslation("INCORRECT_UNSUCCESSFUL1")}}}function f(){$("#incorrectField").hide();if(!UserNotification.formValidated()){$("#simPinChangeAttempts").show();return}throbber.show();var g=$("#pin").val();EnterPin(g,b)}function e(){$(document).on("page.complete",function(){$("#incorrectField").hide();if(productInfo.isQuickStart()){$("#pinRequiredQuickStartParagraph1").show()}else{$("#pinRequiredParagraph1").show()}if(OpCo&&OpCo.country==="Italy"){$("#pinRequiredHelpCol2Paragraph1").show()}$("#pin").focus();$("#pin").off().keypress(function(g){UserNotification.allowOnlyNumbers(g)}).keydown(function(g){if(g.which===13||g.keyCode===13){g.preventDefault();f()}});$("#pin").on("keyup paste",function(h){var g=this;setTimeout(function(){if(/\D/g.test(this.value)){g.value=g.value.replace(/\D/g,"")}},0)});$("body").off("click","#pinRequiredSubmitBtn").on("click","#pinRequiredSubmitBtn",function(g){g.preventDefault();f();return false})})}function a(){e();if(productInfo.isMobileWifi()){$("#simPinStoreToToggle").show();if(!simInfo.isNewPinStoreAPI()){var g=WiFiShared.getWebUiDataValue("pinValue");if(g.length>0){$("#simPinStorePin").attr("checked",true);$("#pin").val(g);EnterPin(g,b);return}else{$("#simPinStorePin").attr("checked",false)}}else{$("#simPinStorePin").attr("checked",VendorWifi.IsPinStored())}}else{$("#simPinStoreToToggle").remove()}$("#webMobileLangSwitch").removeClass("hidden");$("#pinRequiredHelpCol2Paragraph1").show();page.dataReceived()}$.extend(this,{menuName:"PIN_REQUIRED",doSpecificStuff:a,name:"pin-required",parent:"welcome",footer:layout.smallFooter})}function pinstored(){function h(){$("#simPinChangeSuccessful").hide();$("#simPinChangeAttempts").translateElements();if(!$("#remember-me").is(":checked")){if(productInfo.isMobileWifi()){$("#storePinCheckbox").hide()}}else{if(productInfo.isMobileWifi()){if(view.getMode()==="mobileView"&&$.browser.msie){f()}else{$("#storePinCheckbox").show()}}}if(simInfo.simCardStatus().bPinState){if(!$("#remember-me").is(":checked")){$("#pinConfirm, #pinNew").hide()}else{$("#pinConfirm, #pinNew").show()}}}function c(l){if(l){$("#simPinChangeSuccessful").hide();$("#simPinEnterLabel").addClass("error");$("#pin").addClass("error");UserNotification.showResponse({error:true,hintTitleTr:"INCORRECT_UNSUCCESSFUL",hintTextTr:"TR_PLEASE_RE_ENTER"})}else{$("#simPinEnterLabel").removeClass("error");$("#pin").removeClass("error");$("#passwordIncorrect, #pinIncorrectParagraph").hide()}}function a(l){if(l){$("#simPinParagraph1").setTranslation("NOPIN_PARA1_STORED");jQuery("#rememberPin").attr("checked",true)}else{$("#simPinParagraph1").setTranslation("NOPIN_PARA1");jQuery("#rememberPin").attr("checked",false)}$(document).trigger("afterTranslation.view")}function k(l){$("#rememberPin").attr("disabled",!l);$(document).trigger("togglSlider.view",["#rememberPin_flipToggle",l])}var e=true;function b(){function l(){var p=simInfo.isNewPinStoreAPI()?VendorWifi.IsPinStored():WiFiShared.getWebUiDataValue("pinValue").length>0;$(document).trigger("updateSimPinStatus",[p]);a(p)}function n(p){throbber.hide();simInfo.initialiseSimCardStatus();if(p){$("#simPinChangeSuccessful").show();$("#simPinChangeAttempts").translateElements();if(e&&e===true){$("#pinConfirm, #pinNew").show();UserNotification.showResponse({error:false,hintTitleTr:"SIM_ENABLE_SUCCESSFULL",hintTextTr:"SIM_ENABLE_SUCCESSFUL"})}else{UserNotification.showResponse({error:false,hintTitleTr:"SIM_AMEND_SUCCESSFULL",hintTextTr:"SIM_AMEND_SUCCESSFULL1"})}c(false);if(productInfo.isMobileWifi()){var q=$("#pin2").val();if(!q||q===""){q=$("#pin").val()}if(simInfo.isNewPinStoreAPI()){VendorWifi.SetStoredPin({pin:$("#rememberPin").is(":checked")?q:""},l)}else{WiFiShared.setWebUiDataValue("pinValue",$("#rememberPin").is(":checked")?q:"",l)}}}else{if(simInfo.pukRequired()){window.location.replace("home.htm?startPage=puk-required")}else{$("#incorrectField").hide();$("#pinIncorrectParagraph").hide();c(true);$("#simPinChangeAttempts").translateElements()}}$("#pin").val("");$("#pin2").val("");$("#pin3").val("");k(false);f()}function m(s,r){var q=s;var p=r;if(q===p){EnablePin(q,"",n)}else{EnablePin(q,p,n)}}e=false;$("#simPinChangeSuccessful").hide();if(!UserNotification.formValidated()){return}function o(p){throbber.hide();simInfo.initialiseSimCardStatus();if(p){c(false);$("#simPinChangeAttempts").translateElements();$("#simPinChangeSuccessful").show();UserNotification.showResponse({error:false,hintTitleTr:"SIM_DISABLE_SUCCESSFUL1"});$("#pinIncorrectParagraph, #passwordIncorrect").hide();if(productInfo.isMobileWifi()){if(simInfo.isNewPinStoreAPI()){VendorWifi.SetStoredPin({pin:""},l)}else{WiFiShared.setWebUiDataValue("pinValue","",l)}}}else{if(simInfo.pukRequired()){window.location.replace("home.htm?startPage=puk-required")}else{c(true);$("#pinIncorrectParagraph").hide();$("#simPinChangeAttempts").translateElements()}}$("#pin").val("")}throbber.show();if($("#remember-me").prop("checked")){if(simInfo.simCardStatus().bPinState===true){d();if($("#pin2").val()===""&&$("#pin3").val()===""){throbber.hide();UserNotification.showGenericVendorResponse(false);$("#pin").addClass("error");return}if($("#pin").val()===$("#pin2").val()){throbber.hide();UserNotification.showResponse({error:true,hintTitleTr:"TR_GENERIC_FORM_ERROR_HINT_TITLE",hintTextTr:"SIM_PIN_NEW_PIN_SAME_AS_CURRENT_PIN_ERROR"});$("#simPinEnterLabel").addClass("error");$("#simPinChange2Label").addClass("error");$("#pin").addClass("error");$("#pin2").addClass("error");return}if($("#pin2").val()!==$("#pin3").val()){throbber.hide();$("#noMatch").show();$("#simPinChange2Label").addClass("error");$("#simPinChange3Label").addClass("error");$("#pin2").addClass("error");$("#pin3").addClass("error");return}}if(($("#pin2").val()===""&&$("#pin3").val()==="")||($("#pin").val()===$("#pin2").val())){e=true}m($("#pin").val(),$("#pin2").val())}else{if(simInfo.simCardStatus().bPinState===false){throbber.hide();UserNotification.showGenericVendorResponse(false);$("#pin").addClass("error");return}DisablePin($("#pin").val(),o)}}function d(){$("#passwordIncorrect").hide();$("#noMatch").hide();$("#pinNoMatchParagraph").hide();$("#pinIncorrectParagraph").hide();$("#simPinChangeSuccessful").hide()}function j(){if(simInfo.simCardStatus().nSimState!==2){return}$(".textArea,.textAreaRight> :not(#storePinImageAndText)").hide();$("#simPinStatusText").setTranslation("TR_NO_SIM_DETECTED").addClass("redCross");$("#storePinImageAndText").show();UserNotification.showResponse({info:true,hintTitleTr:"TR_No_SIM_inserted",hintTextTr:"TR_PLEASE_INSERT_SIM"});$("#frmSimPin").show();$("#inputFields").hide()}function f(){function m(){var n=UserNotification.validation.validateSimPinOptional;return $("#pin").val().length>0&&$("#pin2").val().length>0&&$("#pin3").val().length>0&&n($("#pin").val())&&n($("#pin2").val())&&n($("#pin3").val())}function l(){var n=UserNotification.validation.validateSimPin;var o=UserNotification.validation.validateSimPinOptional;return $("#pin").val().length>0&&n($("#pin").val())&&o($("#pin2").val())&&o($("#pin3").val())}if(!simInfo.simCardStatus().bPinState){if(l()){k(true)}else{k(false)}}else{if(m()){k(true)}else{k(false)}}}function g(){if(simInfo.redirectIfSimNotReady()){return}if(productInfo.isMobileWifi()){var l=simInfo.isNewPinStoreAPI()?VendorWifi.IsPinStored():WiFiShared.getWebUiDataValue("pinValue").length>0;$(document).trigger("updateSimPinStatus",[l]);a(l);k(false)}UserNotification.validation.validateChangeSimPin=function(m){if($("#pin3").val()!==""){$("#pin3").blur()}return UserNotification.validation.validateSimPinOptional(m)};d();if(productInfo.isQuickStart()){$("#simPinQuickStartParagraph1").show()}else{$("#simPinParagraph1,#storePinImageAndText,#storePinCheckbox,#simPinSettingsHelpCol1,#simPinSettingsHelpCol1Paragraph1,#simPinSettingsHelpCol1Paragraph2").show()}$("#remember-me").prop("checked",simInfo.simCardStatus().bPinState);if(!simInfo.simCardStatus().bPinState){$("#pinConfirm, #pinNew").hide()}h();j();$("body").on("keypress","#pin, #pin2, #pin3",function(m){UserNotification.allowOnlyNumbers(m)}).on("keyup paste","#pin, #pin2, #pin3",function(n){var m=this;setTimeout(function(){f();if(/\D/g.test(this.value)){m.value=m.value.replace(/\D/g,"")}},0)});$("body").on("change",".rememberMe",h).on("click","#simPinSettingsSaveBtn",b);page.dataReceived();setTimeout(function(){$("#inputFields *").translateElements()},0)}$.extend(this,{doSpecificStuff:g,name:"pin-stored",menuName:"SIM_PIN",parent:"network-status",requiresLoggedIn:true,renderLayout:layout.threeColumn,backButton:"settings-mobile"})}function pukrequired(){function e(){if(simInfo.pukRequired()&&simInfo.simCardStatus().nSimPukTimes.toString()==="0"){window.location.replace("home.htm?startPage=puk-lock")}$("#pinNoMatchParagraph, #pinNoMatch, #PukIncorrect, #frmPukRequired").hide();$("body").on("click","#pukRequiredUnblockBtn",d)}function c(){return simInfo.simCardStatus().nSimPukTimes===0?"lock":"ok"}function b(f){if(f==="lock"){$("#pukRemainingAttempts1").setTranslation("PUK_NO_MORE_ATTEMPTS");$("#PukIncorrect").show();$("#PukIncorrectOthers").hide()}else{if(f==="error"){$("#pukRemainingAttempts1").setTranslation("REMAINING_PUK_ATTEMPTS_1");$("#pukRemainingAttempts3").setTranslation("REMAINING_PUK_ATTEMPTS_3");$("#pukEnterAttempts").setTranslation("ATTEMPT1_of10");$("#pinNoMatch, #pinNoMatchParagraph, #pukEnterAttempts").hide();$("#PukIncorrect, #pukEnterAttempts").show();$("#pukEnterLabel, #puk").addClass("error")}else{$("#PukIncorrect").hide()}}$("#frmPukRequired").show()}function a(){e();b(c());if(productInfo.isMobileWifi()){if(simInfo.isNewPinStoreAPI()){VendorWifi.SetStoredPin({pin:""})}else{WiFiShared.setWebUiDataValue("pinValue","")}}UserNotification.validation.validateChangePukSimPin=function(f){if($("#pukpin2").val()!==""){$("#pukpin2").blur()}return UserNotification.validation.validateSimPin(f)};$("#puk, #pukpin, #pukpin2").off().keypress(function(f){UserNotification.allowOnlyNumbers(f)}).keydown(function(f){if(f.which===13||f.keyCode===13){f.preventDefault();d()}});$("#pin").on("keyup paste",function(g){var f=this;setTimeout(function(){if(/\D/g.test(this.value)){f.value=f.value.replace(/\D/g,"")}},0)});$("#webMobileLangSwitch").removeClass("hidden");page.dataReceived()}function d(){function h(){return simInfo.simCardStatus().nSimPukTimes===0?"lock":"error"}function g(j){throbber.hide();if(j){$("#pukEnterLabel").removeClass("error");$("#puk").removeClass().addClass("validated");$("#validationTick").show();window.location.replace("launch.html")}else{simInfo.initialiseSimCardStatus();if(simInfo.simCardStatus().nSimPukTimes.toString()==="0"){window.location.replace("home.htm?startPage=puk-lock")}loadState=h();b(loadState);$("#puk").val("");$("#pin").val("");$("#pin2").val("")}}function f(){var k=$("#puk").val();var j=$("#pukpin").val();EnterPUK(k,j,g)}$("#PukIncorrect").hide();$("#pukRequiredParagraph1").hide();$("#pukEnterLabel, #puk").removeClass("error");if(!UserNotification.formValidated()){return}if($("#pukpin").val()!==$("#pukpin2").val()){$("#pinNoMatch").show();$("#simPinChange2Label").addClass("error");$("#simPinChange3Label").addClass("error");$("#pukpin").addClass("error");$("#pukpin2").addClass("error");return}throbber.show();f()}$.extend(this,{menuName:"PUK_IS_REQUIRED",doSpecificStuff:a,name:"puk-required",parent:"welcome",footer:layout.smallFooter})}function networkunlock(){var d;function h(){return d}function c(){if($("#unlockCodeIncorrect").is(":visible")){$("#unlockCode").val("")}$("#unlockCodeIncorrect").hide()}function b(j){if(j&&!isMCCMNCInRange(networkMccmnc,simLockInfo.mccmnc)){$("#topGlobalNav > :not(#topNavQuickStartContainer)").hide();$("#topNavQuickStartContainer a").removeAttr("data-pagename");$('#menu [id^="mainNavQuickStart"]').hide();$("#mobileBackBtn").hide();$(".webViewSwitch").attr("data-pagename","network-unlock");$(".mobViewSwitch").attr("data-pagename","network-unlock");$(".locked").show();$(".unlocked").hide()}else{$("#topGlobalNav > :not(#topNavQuickStartContainer)").show();$("#topNavQuickStartContainer a").attr("data-pagename","welcome");$(".webViewSwitch").attr("data-pagename","welcome");$(".mobViewSwitch").attr("data-pagename","home-mobile");$("#mobileBackBtn").show();$('#menu [id^="mainNavQuickStart"]').show();$(".locked").hide();$(".unlocked").show();guestUserLogic.processLogInChange()}}function g(l){var k=guestUserLogic.showBearerPreferenceChange();initialiseDeviceLockedStatus();d.remainingAttempts=simLockInfo.remainingAttempts;if(!l){if(d.remainingAttempts===0){window.location.replace("home.htm?startPage=network-locked");return}$("#unlockCode").val("");$("#unlockCodeIncorrect").show();$("#attemptsRemaining").translateElements();$("#networkUnlockCol1Paragraph1").translateElements()}else{var j={button1TrClass:"ERROR_OK unlockedPopUpNoButton",button2TrClass:k?"TR_CONFIGURE_NOW unlockedPopUpYesButton":"",titleTrClass:"TR_DEVICE_UNLOCKED",modHeader:"true",messageTrClass:"TR_DEVICE_NOW_UNLOCKED ",messageTrClass2:"TR_DEVICE_UNLOCKED_PARA_1 ",messageTrClass3:"TR_DEVICE_UNLOCKED_PARA_2",messageTrClass4:k?"":"TR_MUST_LOGGED_IN",containerClass:"networkUnlockedPopup clearfix"};UserNotification.showPrompt(function(m){b(false);if(!m&&k){window.location.replace("home.htm?startPage=connection")}else{window.location.replace("launch.html")}},j)}}function e(){if(!UserNotification.formValidated()){$("div.networkUnlockRight").scrollToMe();return}d.unlockCode=$("#unlockCode").val();UnlockNetwork(d.unlockCode,g)}function f(){$("body").on("click","#networkUnblockBtn",e).on("click","#supportModal",supportModal.showSupportModalClicked).on("click","#unlockCode",c);$(document).on("page.postLoadHTML."+pageLoader.getCurrentEventNamespace(),function(){b(true)});$(document).on("contentTranslated."+pageLoader.getCurrentEventNamespace(),function(){if(pageLoader.getCurrentPageName()==="network-unlock"){b(true)}});$(document).on("phoneNumberChanged",function(){$("#simNumber").translateElements()})}function a(){if(simInfo.redirectIfSimNotReady()){return}if(simLockInfo.mccmnc.length===0){$("body").html("");window.location.replace("launch.html");return}f();var j=simLockInfo.remainingAttempts;d={unlockCode:"",maxAttempts:j.maxAttempts,remainingAttempts:j.remainingAttempts};$("#webMobileLangSwitch").removeClass("hidden");page.dataReceived()}$.extend(this,{footer:layout.smallFooter,doSpecificStuff:a,remainingAndMaxAttempts:h,name:"network-unlock",isLocked:true,parent:"welcome",toggleChrome:b,menuName:"TR_UNLOCK_YOUR_DEVICE_NAME",backButton:"help-mobile"})}function networklocked(){function b(d){if(d&&!isMCCMNCInRange(networkMccmnc,simLockInfo.mccmnc)){$("#topGlobalNav > :not(#topNavQuickStartContainer)").hide();$("#topNavQuickStartContainer a").removeAttr("data-pagename");$(".webViewSwitch").attr("data-pagename","network-locked");$('#menu [id^="mainNavQuickStart"]').hide();$(".locked").show();$(".unlocked").hide()}else{$("#topGlobalNav > :not(#topNavQuickStartContainer)").show();$("#topNavQuickStartContainer a").attr("data-pagename","welcome");$(".webViewSwitch").attr("data-pagename","welcome");$('#menu [id^="mainNavQuickStart"]').show();$(".locked").hide();$(".unlocked").show();guestUserLogic.processLogInChange()}}function c(){$("body").on("click","#supportModal",supportModal.showSupportModalClicked).on("page.complete",function(){b(true)}).on("contentTranslated."+pageLoader.getCurrentEventNamespace(),function(){b(true)})}function a(){c();page.dataReceived()}$.extend(this,{footer:layout.smallFooter,doSpecificStuff:a,name:"network-locked",parent:"welcome",toggleChrome:b,menuName:"TR_DEVICE_LOCKED"})}function networkstatus(){var b;function c(){GetBearerPreference(function(e,d){b=e;getBearerPreferenceCallback(e,d)})}function a(){var d=simInfo.simState();if(d!=="ready"){$("#quickStartStatusNetPref").hide()}if(productInfo.isMobileWifi()){$("#simPinStatusText, #quickStartStatusHelpCol1").show();$(document).trigger("updateSimPinStatus",simInfo.isNewPinStoreAPI()?VendorWifi.IsPinStored():[WiFiShared.getWebUiDataValue("pinValue").length>0])}c();ConnectionManager.setPageConnectionStatusUpdateFunction(function(e){$("#quickStartStatusConnection").attr("class",e.connectionClass).setTranslation(e.connectionTextTr);$("#connectAndDisconnectButton").removeClass().setTranslation(e.connectionButtonTextTr)});connectionInfo.updateConnectionInfo();$("body").on("click",".indexPageConnectBtn",ConnectionManager.toggleConnection);$(document).on("contentTranslated."+pageLoader.getCurrentEventNamespace(),function(){bearerPreference=getLanguageBearerString(b);$("#quickStartStatusNetPref").setTranslation(bearerPreference+(guestUserLogic.showBearerPreferenceChange()?"(%%NETWORK_SETTINGS_ANCHOR_1%%"+languageManager.TR_CHANGE+"%%NETWORK_SETTINGS_ANCHOR_2%%)":""))})}$.extend(this,{doSpecificStuff:a,name:"network-status",menuName:"STATUS",parent:"welcome",children:["network-status","pin-stored","connection","network-settings"],renderLayout:layout.threeColumn,backButton:"settings-mobile"})}function simerror(){function a(){$("#webMobileLangSwitch").removeClass("hidden");page.dataReceived()}$.extend(this,{name:"sim-error",doSpecificStuff:a,parent:"welcome",footer:layout.smallFooter,menuName:"SIM_ERROR_NOTDETECTED"})}function puklock(){function a(){$("#webMobileLangSwitch").removeClass("hidden");page.dataReceived()}$.extend(this,{name:"puk-lock",doSpecificStuff:a,parent:"welcome",footer:layout.smallFooter,menuName:"PUK_Blocked"})}function smsdraft(){function b(){SMS.storeType=4;$(document.body).click(function(){$("#confirmationPopup").hide()})}function a(){b();if(typeof SMS.showSMSPage==="function"){SMS.showSMSPage(urlParams.currentPage?parseInt(urlParams.currentPage,10):1)}if(authentication.isLoggedIn()||productInfo.isQuickStart()){$("body").on("click",".linkable",function(){var c=$(this).parent(this).attr("data-pageparameters");pageLoader.loadPage("sms-write2",c)})}$("body").on("click",'input[type="checkbox"]',SMS.disableEnableFooterButtons)}$.extend(this,{doSpecificStuff:a,name:"sms-draft",menuName:"INBOX_DRAFT",parent:"sms-inbox",backButton:"sms-mobile",requiresLoggedIn:true})}function smsinbox(){function b(){SMS.storeType=2;$(document.body).click(function(){$("confirmationPopup").hide()})}function a(){b();if(typeof SMS.showSMSPage==="function"){SMS.showSMSPage(urlParams.currentPage?parseInt(urlParams.currentPage,10):1)}if(authentication.isLoggedIn()||productInfo.isQuickStart()){$("body").on("click",".linkable",function(){var c=$(this).parent(this).attr("data-pageparameters");pageLoader.loadPage("sms-write",c)})}$("body").on("click",'input[type="checkbox"]',SMS.disableEnableFooterButtons)}$.extend(this,{doSpecificStuff:a,parent:"sms-inbox",name:"sms-inbox",menuName:"INBOX_TITLE",backButton:"sms-mobile",requiresLoggedIn:true})}function smssent(){function b(){SMS.storeType=3}function a(){b();if($.isFunction(SMS.showSMSPage)){SMS.showSMSPage(urlParams.currentPage?parseInt(urlParams.currentPage,10):1)}if(authentication.isLoggedIn()||productInfo.isQuickStart()){$("body").on("click",".linkable",function(){var c=$(this).parent(this).attr("data-pageparameters");pageLoader.loadPage("sms-write",c)})}$("body").on("click",'input[type="checkbox"]',SMS.disableEnableFooterButtons)}$.extend(this,{doSpecificStuff:a,name:"sms-sent",menuName:"INBOX_SENT",parent:"sms-inbox",backButton:"sms-mobile",requiresLoggedIn:true})}function smssettings(){function f(){var g=OpCo.title;$("#smsSettingsParagraph1").html(g)}function b(){function g(l){function j(m){UserNotification.showGenericVendorResponse(m);if(!m){Util.log("setMessageCenterCallback failed")}}var k=l.value;SetMessageCenter(k,j)}if(!UserNotification.formValidated()){return}var h=document.getElementById("messageCenter");g(h);SetMessagePreview(document.getElementById("messagePreviewRadio1").checked)}function c(){var g=document.getElementById("messageCenter");g.value=OpCo.message_centre_number;$("#messagePreviewRadio1").prop("checked",true).trigger("changeSelect.view",1)}function d(){function g(j,h){if(h&&typeof j==="string"){$("#messageCenter").val(j)}else{Util.log("getMessageCenterCallback failed")}page.dataReceived()}GetMessageCenter(g)}function e(){d()}function a(){var g=IsMessagePreview()?document.getElementById("messagePreviewRadio1"):document.getElementById("messagePreviewRadio2");g.checked=true;$("body").on("click","#smsSettingsSaveBtn",b).on("click","#smsSettingsDefaultBtn",c);e()}$.extend(this,{doSpecificStuff:a,parent:"sms-inbox",name:"sms-settings",menuName:"INBOX_SETTINGS",backButton:"sms-mobile",requiresLoggedIn:true})}function smsredirect(){function b(){$(document).on("page.complete",function(){throbber.show()})}function a(){b();if($.isFunction(SMS.showSMSPage)){SMS.storeType=2;SMS.showSMSPage(1)}if(authentication.isLoggedIn()||productInfo.isQuickStart()){$("body").on("click",".linkable",function(){var c=$(this).parent(this).attr("data-pageparameters");pageLoader.loadPage("sms-write",c)})}}$.extend(this,{doSpecificStuff:a,parent:"welcome",name:"sms-redirect",menuName:"TR_MOBILE_VIEW_NEW_SMS_RECEIVED"})}function smswrite(){function b(){if(!UserNotification.formValidated()){return}throbber.show();var k=GreekChar.GreekStringSubstitution(Util.checkSMSWaterMark($("#smsReply")));SMS.sendSMS(-1,[urlParams.num],k)}function c(){pageLoader.loadPage("sms-write2","message="+encodeURIComponent(urlParams.message))}function a(){if(!UserNotification.formValidated()){return}SMS.saveSMSMessage(document.getElementById("smsReply").value,urlParams.num,-1,SMS.saveSMSMessageCallback)}function e(){var k=SMS.replaceURLWithHTMLLinks($("#smsMessageTextToReply").text());exp=/(\b(mailto):[\-A-Z0-9+&@#\/%?=~_|!:,.;]*[\-A-Z0-9+&@#\/%=~_|])/ig;k=k.replace(exp,"<a href='$1'>$1</a>");k=k.replace(/\\r\\n|\\n/g,"<br>");k=SMS.makePhoneNumberActive(k);$("#txtLinks").html(k)}function f(k){k.parent("ul").find("li").removeClass("current");k.addClass("current")}function h(){page.menuName=d();$("#smsReply").createFieldPlaceholder("ENTER_YOUR_RESPONSE");if($.browser.msie){$("body").on("focus","#smsReply",smsCharCounter.startCountingChars).on("blur","#smsReply",smsCharCounter.stopCountingChars)}else{$("body").on("keyup input","#smsReply",smsCharCounter.countChars)}$("#smsReply").translateElements();$(document).on("page.complete",function(){$("#pageTitle, #fillTextHelper").setTranslation(d());$("#smsReply").keyup().blur();var l=urlParams.page==="1";var k=l?$("#mainNavSmsSent"):$("#mainNavSmsWrite");f(k);if(l){$(".smsinbox").hide()}$("#smsReadTitle").toggle(l);$("#smsWriteTitle").toggle(!l)})}function g(){h();if(urlParams.id){SetMessageRead(parseInt(urlParams.id,10),$.noop)}var m="";if(urlParams.from){if(!/^[0-9+\-\s]*$/g.test(urlParams.from)){$("#smsSettingsReplyBtn, #smsReplyLabel, #smsReply, #characterCount, #smsCount").hide()}var k=urlParams.from.split(";");var o;for(o=0;o<k.length;o++){if(o!==0){m+="<br>"}m+=k[o]}}if(urlParams.date&&urlParams.time){var q={date:urlParams.date,time:urlParams.time};var l=SMS.convertMessageDateAndTimeToJavaScriptDate(q);var n=l.getMinutes().toString();var p=l.getHours()+":"+(n.length>1?n:"0"+n);m+="<br/>"+l.toLocaleDateString();m+=" "+p}$("#smsFromMessageLabel").html(m);$("#smsForwardBtn").show();if(urlParams.message){$("#smsMessageTextToReply").text(SMS.htmlEntities(urlParams.message))}if(urlParams.from){$("#smsRecipient").html(urlParams.from)}e();$("body").on("click","#smsSettingsDraftBtn",a).on("click","#smsSettingsReplyBtn",b).on("click","#smsForwardBtn",c).on("click","#smsSettingsCloseBtn",function(){pageLoader.loadPage(urlParams.page==="0"?"sms-inbox":"sms-sent","currentPage="+SMS.getCurrentPageNum())});page.dataReceived()}function d(){var k=urlParams.page==="1";return k?"READ":"TITLE_AND_NUMBER_1"}function j(){return SMS.getBackButton()}$.extend(this,{doSpecificStuff:g,parent:"sms-inbox",name:"sms-write",menuName:d(),backButton:j,requiresLoggedIn:true})}function smswrite2(){var m=false;function h(){var q=$("#mainContent").clone();var r=$("#throbber").clone();$("body").html(q).append(r);$(".contextualHelp").remove();$("#smsRecipient").css("border","1px solid #DADADA");if(urlParams.hideTo&&urlParams.hideTo==="on"){$('[id^="smsRecipient"]').hide()}$("#smsSettingsDraftBtn").remove();$(".modHeader").hide()}function b(q){$("#throbber").hide();if(q){UserNotification.showResponse({error:false,hintTitleTr:"MESSAGE_SENT",hintTextTr:""});$("#form > :not(#updateMessage),.smsWriteBtns").hide()}else{UserNotification.showResponse({error:true,hintTitleTr:"TR_PLEASE_TRY_LATER",hintTextTr:""})}}function d(){if(urlParams.page&&urlParams.page==="1"){var q=document.getElementById("smsRecipient");q.disabled="disabled";q=document.getElementById("smsReply");q.disabled="disabled";$("#smsSettingsDraftBtnText").setTranslation("WRITE_CLOSE");$("body").off("click","#smsSettingsDraftBtn").on("click","#smsSettingsDraftBtn",function(){pageLoader.loadPage("sms-sent");return false});$("#smsSettingsDraftBtn").removeAttr("href");$("#smsSendButtonText").setTranslation("SENT_DELETE");$("body").off("click","#smsSendBtn").on("click","#smsSendBtn",function(){DeleteSMS(urlParams.id,function(){pageLoader.loadPage("sms-sent");return false})});$("#smsForwardBtn").show();$("#letterCount").hide();$("#smsWrite2Title").setTranslation("READ")}}function c(){if(!UserNotification.formValidated()){return}throbber.show();var q=GreekChar.GreekStringSubstitution(Util.checkSMSWaterMark($("#smsReply")));if(m){SMS.sendSMS(urlParams.id?parseInt(urlParams.id,10):-1,$("#smsRecipient").val().split(";"),q,b)}else{SMS.sendSMS(urlParams.id?parseInt(urlParams.id,10):-1,$("#smsRecipient").val().split(";"),q)}}function a(){var q=$("#smsRecipient").val();if(q.length>0&&q!==languageManager.WRITE2_RECIPIENT_NUMBER){if(!UserNotification.formValidated()){return}}$("#smsSettingsDraftBtn, #smsSendBtn").prop("disabled",true).addClass("disabled");SMS.saveSMSMessage(document.getElementById("smsReply").value,q,urlParams.page==="2"?parseInt(urlParams.id,10):-1,SMS.saveSMSMessageCallback)}function e(){pageLoader.loadPage("sms-write2","message="+encodeURIComponent(urlParams.message))}function j(){var q=$("#smsRecipientLabel").textWidth();var r=$("#smsWrite2Label").textWidth();var s=q>r?q:r;$("#smsRecipientLabel, #smsWrite2Label").width(s+10)}function f(r){var q=$(this);setTimeout(function(){smsCharCounter.countChars(r,q)},0)}function o(){$("body").find("input,textarea").click(function(){$("#updateMessage").remove()});if($.browser.msie){$("body").on("focus","#smsReply",smsCharCounter.startCountingChars).on("blur","#smsReply",smsCharCounter.stopCountingChars)}else{$("body").on("keyup input paste","#smsReply",f)}smsCharCounter.countChars(null,$("#smsReply"));$("#smsReply").createFieldPlaceholder("ENTER_YOUR_RESPONSE");$("#smsRecipient").createFieldPlaceholder("WRITE2_RECIPIENT_NUMBER");$(".actionConfirmation").hide();$(document).off("translated",j).on("page.complete translated",j)}function g(q){if(q){$("#smsSendBtn").removeClass("disabled");$("body").off("click","#smsSendBtn").on("click","#smsSendBtn",c)}else{$("#smsSendBtn").addClass("disabled");$("body").off("click","#smsSendBtn")}}function l(){if(typeof SendSmsToRecipients==="function"){$("#smsRecipient").attr("data-validator","PhoneNumbers")}}function n(){$("body").on("keyup paste mouseup focusout","#smsRecipient",function(){setTimeout(function(){function r(){var s=$("#smsRecipient").val();return UserNotification.validation.validatePhoneNumbers(s)}g(r())},0)});if(urlParams.recipient){$("#smsRecipient").val(urlParams.recipient).removeClass("WRITE2_RECIPIENT_NUMBER")}g(urlParams.recipient);if(urlParams.message){var q=urlParams.message;$("#smsReply").html(SMS.htmlEntities(q)).val(q);$("#smsReply").keyup();$("#smsReply").focus();if(!$("#smsReply").attr("readonly")){$("#smsReply").removeClass("ENTER_YOUR_RESPONSE").data("hasPlaceHolder",false)}}$("body").off("click","#smsSettingsDraftBtn").on("click","#smsSettingsDraftBtn",a).off("click","#smsForwardBtn").on("click","#smsForwardBtn",e)}function k(){m=urlParams.bareSMS?urlParams.bareSMS.toLowerCase()==="on":false;if(m){h()}l();o();d();n();page.dataReceived()}function p(){return SMS.getBackButton()}$.extend(this,{doSpecificStuff:k,parent:"sms-inbox",name:"sms-write2",menuName:"INBOX_WRITE",backButton:p,requiresLoggedIn:true})}function sobe(){function a(){page.dataReceived();$("#supportModal").attr("href","http://setup.vodafone.com/GLP/faq.htm?action=showFaq")}$.extend(this,{menuName:"ACTIVATE_MB",doSpecificStuff:a,name:"SOBE",parent:"welcome",footer:layout.smallFooter})}function topup(){var f="0.00";var l="";var r=false;var u;function s(){var L=$("input:radio[name=purchaseBundles]");var K=$("#dataBundleDropDown").val();L.filter("[id="+K+"]").attr("checked",true)}function x(){if(OpCo){pageLoader.logger.debug("top-up.addOpCoDataBundleText("+OpCo.dataBundleIntro+")("+OpCo.dataBundleImportantTitle+")("+OpCo.dataBundleImportantPara+")("+OpCo.dataBundleInfoText+")");$("#dataBundleIntro").html(OpCo.dataBundleIntro);$("#dataBundleImpTitle").html("<strong>"+OpCo.dataBundleImportantTitle+"</strong>");$("#dataBundleImpPara").html(OpCo.dataBundleImportantPara);if("undefined"!==typeof OpCo.dataBundleInfoLink[0]){pageLoader.logger.debug("top-up.addOpCoDataBundleText("+OpCo.dataBundleInfoLink[0].InfoLink+")");$("#dataBundleInfoLink").attr("href",OpCo.dataBundleInfoLink[0].InfoLink)}$("#dataBundleInfoLink").html(OpCo.dataBundleInfoText)}}function B(){var K=opCoInfo.isDutch()||opCoInfo.isGhanaian()||opCoInfo.isIrish()||opCoInfo.isSouthAfrican()||opCoInfo.isSpanish();if(!(typeof testing==="boolean"&&testing)){pageLoader.logger.debug("top-up.isDataBundleOpCo("+K+"), OpCo.country("+OpCo.country+")")}return K}function a(){$("#accountTopupPasswordLabel").show();$("#accountTopupPasswordText").show()}function h(){pageLoader.logger.debug("top-up.doSouthAfricaPurchaseTerms("+OpCo.dataBundlePurchaseTerms+")");var L={};var K=0;for(K=0;K<OpCo.dataBundlePurchaseTerms.length;K++){L={index:K+1,name:OpCo.dataBundlePurchaseTerms[K].name};var M=$.tmpl(HTMLTemplates.purchaseTerms,L);$("#opCoPurchaseTerm1").attr("checked","checked");$("#purchaseTerms").append(M)}}function C(K){$("#throbberPurchase").hide();clearTimeout(u);$("#confirmPopupYesBtn").removeClass("disabled");$(".genericPopup #dataBundleImpTitle").hide();$(".genericPopup #dataBundleImpPara").hide();$(".genericPopup #dataBundleInfoLink").hide();$("#purchaseBundles").hide();if(K){if(opCoInfo.isGhanaian()&&r){$("#confirmPopupNoBtn").removeClass("disabled")}else{$(".genericPopup #confirmPopupNoBtn").hide();$(".TR_ERROR_CANCEL").text(languageManager.WRITE_CLOSE)}}else{$(".genericPopup .DATA_BUNDLE_BUY").text(languageManager.DATA_BUNDLE_RETRY);$("#confirmPopupNoBtn").removeClass("disabled")}}function g(K,L){pageLoader.logger.debug("top-up.sendUSSDBuyCallBack("+L+")");if(L==="USSD NOT SUPPORTED"){UserNotification.showGenericVendorResponse(false,{hintTitleTr:"TR_PLEASE_TRY_LATER",hintTextTr:""});$("#throbberPurchase").hide();$("#dataBundleBuyPrompt").hide();return}var N=K&&L.toLowerCase().indexOf("invalid")===-1;C(N);if(N){var M=L.replace("Press 1","Press Buy").replace("Press #","Press Cancel");$("#genericPopupParagraph1").setTranslation(r?M:"DATA_BUNDLE_SUCCESSFUL");if(!r){$("#genericPopupParagraph1").after('<p id="genericPopupParagraph2"></p>');$("#genericPopupParagraph2").text(L)}}else{$("#genericPopupParagraph1").setTranslation(languageManager.DATA_BUNDLE_UNSUCCESSFUL+"</br>"+languageManager.DATA_BUNDLE_TRY_AGAIN);$("#genericPopupParagraph1").after('<p id="genericPopupParagraph2"></p>');$("#genericPopupParagraph2").setTranslation("ACCOUNT_BALANCE_TEXT_2")}}function J(){pageLoader.logger.debug("top-up.ussdTimedOut()");$("#throbberPurchase").hide();C(false);$("#genericPopupParagraph1").setTranslation(languageManager.DATA_BUNDLE_TIMED_OUT+"</br>"+languageManager.DATA_BUNDLE_TRY_AGAIN);$("#genericPopupParagraph1").after('<p id="genericPopupParagraph2"></p>');$("#genericPopupParagraph2").setTranslation("ACCOUNT_BALANCE_TEXT_2")}function d(){pageLoader.logger.debug("top-up.smsTimedOut()");$("#throbberPurchase").hide();C(true);$("#genericPopupParagraph1").setTranslation(languageManager.DATA_BUNDLE_TIMED_OUT+"</br>"+languageManager.DATA_BUNDLE_TRY_AGAIN);$("#genericPopupParagraph1").after('<p id="genericPopupParagraph2"></p>');$("#genericPopupParagraph2").setTranslation("DATA_BUNDLE_CHECK_SMS_INBOX")}function c(L,M){if(typeof pageLoader.logger==="object"){pageLoader.logger.debug("top-up.getUssdNumForBuyBundle("+L+")("+M+")")}var K="";if(M!==""&&(opCoInfo.isSouthAfrican()||opCoInfo.isGhanaian())){K=M[L].ussdNum}else{K=OpCo.dataBundles[L].ussdNum}return K}function m(N,M){var L=$("input[name=purchaseBundles]:checked").val();var K=c(L,N);u=setTimeout(J,120000);pageLoader.logger.debug("top-up.sendUSSDAndGetResponse SendUSSDAndGetResponse("+K+")");SendUSSDAndGetResponse(K,M)}function H(K){pageLoader.logger.debug("top-up.sendGhanaBuyOrCancelCommand, command is :"+K);r=false;switch(K){case"1":SendUSSDAndGetResponse(K,g);break;case"#":SendUSSDAndGetResponse(K,$.noop);break}}function F(){var L=$("input[name=purchaseBundles]:checked").val();var M=[OpCo.dataBundles[L].smsNum];var K=OpCo.dataBundles[L].smsBody;var N=function(O){if(!O){pageLoader.logger.debug("dataBundle buy has failed");C(false);$("#genericPopupParagraph1").setTranslation(languageManager.DATA_BUNDLE_UNSUCCESSFUL+"</br>"+languageManager.DATA_BUNDLE_TRY_AGAIN)}};u=setTimeout(d,120000);pageLoader.logger.debug("about to send sms to : "+M[0]+" with message: "+K);SMS.sendSMS("-1",M,K,N)}function G(M,L){var K="#"+M+" :input";$(K).attr("disabled",L)}function E(M){var L="";if(!M){M=OpCo.dataBundles}if("undefined"!==typeof OpCo.dataBundleInfoLink[0]){L=OpCo.dataBundleInfoLink[0].InfoLink}var K={button1TrClass:"TR_ERROR_CANCEL",button2TrClass:"DATA_BUNDLE_BUY",titleTrClass:"DATA_BUNDLE_PURCHASE_INFORMATION",messageTrClass:"DATA_BUNDLE_SELECT_DATA_BUNDLE",containerClass:"dataBundleBuyPopup",impTitleText:OpCo.dataBundleImportantTitle,impParaText:OpCo.dataBundleImportantPara,infoLinkText:OpCo.dataBundleInfoText,infoLinkHref:L,dataBundles:M};UserNotification.showBundlePrompt(function(N){if(N){if($("#confirmPopupNoBtn").text()!==languageManager.DATA_BUNDLE_RETRY){if($("#throbberPurchase").length===0){$("#dataBundleBuyPrompt").append('<div id="throbberPurchase"><div class="throbberWhiteBg" ><img src="img/icons/loading.gif"><br><span id="attempting" class = "attempting DATA_BUNDLE_ATTEMPTING_PURCHASE"></span></div></div>')}else{$("#throbberPurchase").show()}G("purchaseBundles",true);$(".genericPopup #dataBundleInfoLink").hide();$("#attempting").translateElements();$("#confirmPopupNoBtn").addClass("disabled");$("#confirmPopupYesBtn").addClass("disabled");if(r){H("1");return}if(Util.findIndexByKeyinJsonArray(OpCo.dataBundles,"ussdNum")!==null||opCoInfo.isSouthAfrican()||opCoInfo.isGhanaian()){r=opCoInfo.isGhanaian()&&OpCo.account_type==="Prepaid";m(M,g)}else{F()}}else{r=false;$(".genericPopup #dataBundleImpTitle").show();$(".genericPopup #dataBundleImpPara").show();$(".genericPopup #dataBundleInfoLink").show();$(".genericPopup #confirmPopupNoBtn").show();$("#purchaseBundles").show();$(".genericPopup .TR_ERROR_CANCEL").text(languageManager.TR_ERROR_CANCEL);$(".genericPopup .DATA_BUNDLE_BUY").text(languageManager.DATA_BUNDLE_BUY);G("purchaseBundles",false);$(".genericPopup #dataBundleInfoLink").show();$("#genericPopupParagraph1").setTranslation("DATA_BUNDLE_SELECT_DATA_BUNDLE");$("#genericPopupParagraph2").hide()}}else{if(r){H("#")}}},K)}function n(O){if("object"===typeof pageLoader.logger){pageLoader.logger.debug("top-up.parseGhanaDataBundleBuyResponse("+O+")")}var P=$.grep(O.split(/\r\n|\r|\n/),function(T){return(T)});var S=[];var N=0;for(N=0;N<P.length;N++){var Q=P[N].split(",");var M=$.trim($.trim(Q[0]).split(".")[0]);var L=$.trim(Q[0]).split(".")[1];var R=Q[2];var K=Q[1];if(Q.length>3){S[N]={dataBundle:P[N],ussdNum:M}}else{if($.trim(L).toLowerCase()!=="more"){S[N]={dataBundle:L,price:R,size:K,ussdNum:M}}}}if("object"===typeof pageLoader.logger){pageLoader.logger.debug("top-up.parseGhanaDataBundleBuyResponse("+S+")")}return S}function I(M){if("object"===pageLoader.logger){pageLoader.logger.debug("top-up.parseSouthAfricaDataBundleBuyResponse("+M+")")}var Q=M.substring(M.indexOf(":")+1,M.length);var L=Q.split("/");var R=[];var O=0;for(O=0;O<L.length;O++){var N=L[O].split(":")[0];var P=L[O].split(":")[1];var K=OpCo.dataBundlePurchaseTerms[l-1].ussdNum;K=K.substring(0,K.length-1)+"*"+(O+1)+"#";R[O]={dataBundle:N,price:P,ussdNum:K}}if("object"===pageLoader.logger){pageLoader.logger.debug("top-up.parseSouthAfricaDataBundleBuyResponse("+R+")")}return R}function q(K,L){clearTimeout(u);pageLoader.logger.debug("top-up.sendSouthAfricanUSSDCallback result("+K+"), response("+L+")");if(L==="USSD NOT SUPPORTED"){UserNotification.showGenericVendorResponse(false,{hintTitleTr:"TR_PLEASE_TRY_LATER",hintTextTr:""});return}var M=I(L);E(M)}function e(K,L){pageLoader.logger.debug("top-up.sendGhanaianUSSDCallback result("+K+"), response("+L+")");clearTimeout(u);if(L.toLowerCase().indexOf("invalid")!==-1||L==="USSD NOT SUPPORTED"){throbber.hide();UserNotification.showGenericVendorResponse(false,{hintTitleTr:"TR_PLEASE_TRY_LATER",hintTextTr:""});return}var M=n(L);E(M)}function k(){throbber.show();u=setTimeout(J,120000);switch(OpCo.country){case"South Africa":SendUSSDAndGetResponse(OpCo.dataBundlePurchaseTerms[l-1].ussdNum,q);pageLoader.logger.debug("top-up.sendDataPurchaseTermUSSDAndGetResponse for "+OpCo.country+" SendUSSDAndGetResponse("+OpCo.dataBundlePurchaseTerms[l-1].ussdNum+")");break;case"Ghana":SendUSSDAndGetResponse(OpCo.dataBundlePurchaseTerms[0].ussdNum,e);pageLoader.logger.debug("top-up.sendDataPurchaseTermUSSDAndGetResponse for "+OpCo.country+" SendUSSDAndGetResponse("+OpCo.dataBundlePurchaseTerms[0].ussdNum+")");break;default:pageLoader.logger.debug("OpCo does not support USSD purchase term retrievel")}}function v(){if(opCoInfo.isDutch()){window.open(OpCo.dataBundleInfoLink[1].BundleLink);return}if(opCoInfo.isSouthAfrican()){l=$("input[name=purchaseTerms]:checked").val();pageLoader.logger.debug("top-up.onDataBuyClick for SA SendUSSDAndGetResponse("+OpCo.dataBundlePurchaseTerms[l-1].ussdNum+")");k();return}if(opCoInfo.isGhanaian()&&OpCo.account_type==="Prepaid"){k();return}E()}function j(K){$("#accountTopupThankyou").toggleClass("notick",!K)}function y(K){f=formatting.formatTopUpBalance(K);f=f.replace(/\\n/g,"<br/>");if(!$("#accountTopupThankyou").hasClass("TOP_UP_SUCCESSFUL")){$("#accountTopupThankyou").setTranslation("TOPUP2_BTN_TEXT")}else{$("#accountTopupThankyou").translateElements()}$("#topUpUnsuccessful").hide();$("#accountTopupThankyou").show();j(true)}function p(K){K=K.replace(/\\n/g,"<br />");K=K.replace(/\n/g,"<br />");$("#accountTopupThankyou").html(K);$("#topUpUnsuccessful").hide();$("#accountTopupThankyou").show();j(false)}function t(K,L){pageLoader.logger.debug("top-up.updateTopUpStatusLabel result("+K+") response: "+L);clearTimeout(u);$("#updateMessage").remove();$(".error, #accountTopupThankyou").hide();if(L==="USSD NOT SUPPORTED"){UserNotification.showGenericVendorResponse(false,{hintTitleTr:"TR_PLEASE_TRY_LATER",hintTextTr:""});return}if(K&&L){if(OpCo.top_up_by_voucher==="USSD_SMS"){return}if(typeof networkMccmnc==="number"&&networkMccmnc===23415){f=formatting.formatTopUpBalance(L);f=f.replace(/\\n/g,"<br/>");$("#accountTopupThankyou").setTranslation("TOPUP2_BTN_TEXT");$("#topUpUnsuccessful").hide();$("#accountTopupThankyou").show();j((f.indexOf("")!==-1))}else{if(L.indexOf(OpCo.topup_successful_pattern)!==-1&&OpCo.topup_successful_pattern!==""){y(L)}else{p(L)}}}else{UserNotification.showResponse({error:true,hintTitleTr:"TR_PLEASE_RE_ENTER",hintTextTr:"REENTER_CODE"})}throbber.hide()}updateTopUpForSMS=function(L,K){if((K.from!==OpCo.prepay.topup&&OpCo.top_up_by_voucher!=="USSD_SMS")||page.name!=="top-up"){return}clearTimeout(u);$("#accountTopupTimeoutError").empty();if(K.body.indexOf(OpCo.topup_successful_pattern)!==-1&&OpCo.topup_successful_pattern!==""){y(K.body)}else{p(K.body)}throbber.hide()};function w(M){var K=document.getElementById("accountTopupVoucherText");if(K){var N=M.split("%")[0]+K.value+"#";if(opCoInfo.isTurkish()){var L=document.getElementById("accountTopupPasswordText");if(L){N+=L.value+"#"}}pageLoader.logger.debug("top-up.performTopUp SendUSSDAndGetResponse("+N+")");SendUSSDAndGetResponse(N,t)}}function A(){UserNotification.showResponse({error:true,hintTitleTr:"TR_REQUEST_TIMED_OUT",hintTextTr:"TR_PLEASE_CHECK_BALANCE_PAGE",callback:function(K){K.appendTo($("#accountTopupTimeoutError"))}});throbber.hide()}function b(){if(!UserNotification.formValidated()){return}$("#updateMessage").remove();if(OpCo.top_up_by_voucher==="USSD"||OpCo.top_up_by_voucher==="USSD_SMS"){throbber.show();u=setTimeout(A,130000);w(OpCo.prepay.topup)}else{if(OpCo.top_up_by_voucher==="SMS"){throbber.show();u=setTimeout(A,130000);var L=OpCo.topup_sms_message.split("%")[0]+$("#accountTopupVoucherText").val();var K=[OpCo.prepay.topup];var M=function(N){if(!N){UserNotification.showGenericVendorResponse(N,{hintTitleTr:"TR_PLEASE_TRY_LATER",hintTextTr:""});clearTimeout(u)}};SMS.sendSMS("-1",K,L,M)}}}function z(){$("#topUpUnsuccessful,#accountTopupThankyou").hide()}function D(){if(opCoInfo.isSouthAfrican()){h()}if(opCoInfo.isTurkish()){a()}if(B()){x()}else{$("#dataBundle").hide()}}dataBundleResponse=function(M,L){if((OpCo.dataBundles.length>0&&OpCo.dataBundles[0].hasOwnProperty("smsNum")&&L.from!==OpCo.dataBundles[0].smsNum)||page.name!=="top-up"){return}C(true);var K=L.body.replace(/\\n/g,"<br/>");$("#genericPopupParagraph1").html(K)};function o(){z();$(document).on("page.complete",D);UserNotification.validation.validateVoucherCode=function(K){function L(O){var N;for(N=0;N<O.length;N++){if(O.charCodeAt(N)>255){return true}}return false}if(K.length===0){return false}var M=OpCo.prepay.topup.split("%")[0]+K+"#";return L(M)?M.length<81:M.length<161};$(document).on("numbersToMonitor.newDataArrived",updateTopUpForSMS).on("numbersToMonitor.newDataArrived",dataBundleResponse);$("body").on("click","#accountTopupBtn",b).on("click","#dateBundleBuy",v);page.dataReceived()}$.extend(this,{doSpecificStuff:o,parent:"account",name:"top-up",menuName:"TOPUP_TITLE_TOPUP",backButton:"account-mobile",selectDataBundle:s,parseSouthAfricaDataBundleBuyResponse:I,getUssdNumForBuyBundle:c,setDataBundlePurchaseTermRadio:function(K){l=K},requiresLoggedIn:true})}function homemobile(){function a(){if(IsMessagePreview()&&$.isFunction(SMS.showSMSPage)){SMS.storeType=2;SMS.showSMSPage(1);if(authentication.isLoggedIn()||productInfo.isQuickStart()){$("body").on("click",".linkable",function(){var b=$(this).parent(this).attr("data-pageparameters");pageLoader.loadPage("sms-write",b)})}else{$(".linkable").css("background-image","none")}}$("#webMobileLangSwitch").removeClass("hidden");if(!IsMessagePreview()){$("#smsFunctions").hide();this.dataReceived()}}$.extend(this,{views:["mobileView"],doSpecificStuff:a,name:"home-mobile"})}function accountmobile(){$.extend(this,{views:["mobileView"],name:"account-mobile",menuName:"AB_TOP_ACCOUNT",children:["account-balance","top-up","account-details","account-type"],backButton:"home-mobile",requiresLoggedIn:true})}function settingsmobile(){$.extend(this,{views:["mobileView"],name:"settings-mobile",menuName:"MOBILE_BROADBAND",requiresLoggedIn:false,isMobileWifi:true,parent:"welcome",children:["network-status","pin-stored","connection","network-settings"],backButton:"home-mobile"})}function smsmobile(){$.extend(this,{views:["mobileView"],name:"sms-mobile",parent:"home-mobile",children:["sms-inbox","sms-write2","sms-sent","sms-draft","sms-settings"],menuName:"TR_MOBILE_VIEW_SMS",backButton:"home-mobile",requiresLoggedIn:true})}function cloudstorage(){function a(){page.dataReceived()}$.extend(this,{doSpecificStuff:a,name:"cloud-storage",menuName:"TR_CLOUD",parent:"welcome",backButton:"settings-mobile"})};
